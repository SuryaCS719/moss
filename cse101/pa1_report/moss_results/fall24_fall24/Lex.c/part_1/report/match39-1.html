<html>
<head>
<title>/fall24/atesterm/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/atesterm/pa1/Lex.c<p></p><pre>
//---------------------------------------------------------------------
// AJ Testerman
// atesterm
// CSE101 pa1
// Lex.c
//---------------------------------------------------------------------
#include "List.h"
#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdbool.h&gt;
#include &lt;string.h&gt;

#define MAX_LEN 300
#define END_OF_STRING '\n'

<a name="0"></a><font color="#FF0000"><a href="match39-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_98.gif"/></a>

int main(int argc, char * argv[]){ // argv[0] = Lex.c, argv[1] = input file, argv[2] = output file
   if( argc != 3 ){
      fprintf(stderr,"Lex error: need 2 command line arguments, input file and output file.\n");
      exit(EXIT_FAILURE);
   }
   FILE *in, *out; 
   int line_count, i;
   char line[MAX_LEN];
    
   in = fopen(argv[1], "r");
   if( in==NULL ){
      printf("Unable to open file %s for reading\n", argv[1]);
      exit(EXIT_FAILURE);
   }
   line_count = 0;
   while( fgets(line, MAX_LEN, in) != NULL)  {
      line_count++;
   }
   //printf("file %s has %d lines\n", argv[1], line_count);
   fclose(in);

   char** A = calloc(line_count, sizeof(char*));
   in = fopen(argv[1], "r");
   if( in==NULL ){
      printf("Unable to open file %s for reading\n", argv[1]);
      exit(EXIT_FAILURE);
   }
   i=0;
   char *has_end;
   while( fgets(line, MAX_LEN, in) != NULL){
      has_end = strchr(line, END_OF_STRING);
      if(has_end == NULL){ // make sure all strings end in '\n'
         strcat(line, "\n");
      }
      A[i] = calloc(strlen(line)+1, sizeof(char));
      strcpy(A[i], line);
      printf("Array index %d has contents: %s", i, A[i]);
      i++;
   }
   fclose(in); // no longer need in file open now that A is filled
   
   List L = newList();
   append(L, 0);
   moveFront(L);
   for(i = 1; i &lt; line_count; i++){
      //printf("inside for loop, i = %d\n", i);
      while( index(L)&gt;=0 ){
         //printf("inside while loop, index(L) = %d  with value %s, A[i] = %s\n", index(L), A[get(L)], A[i]);
         //printf("strcmp '%s' and '%s' is %d\n",A[i], A[index(L)], strcmp(A[i], A[index(L)]));
         if(strcmp(A[i], A[get(L)]) &lt; 0){
            //printf("inside if statement\n");
            insertBefore(L, i);
            //printf("inserted %d into list before index(L). L = ", i);
            //printList(stdout,L);
            moveBack(L);
            moveNext(L); // set index(L) = -1
         }
         else{
            //printf("inside else statement\n");
            moveNext(L);
         }
      }
      // check if L is the same length as before while loop
      if(length(L)==i){
         // need to add i to the end of the list
         append(L, i);
         //printf("appended %d to the end of L, L = ", i);
         //printList(stdout, L);
      }
      // reset index to front of list for next loop
      moveFront(L);
      //printf("index L reset to 0\n");
   }
   //printf("L = ");
   //printList(stdout, L);

   out = fopen(argv[2], "w");

   moveFront(L);
   for(i = 1; i &lt;= line_count; i++){
      fprintf(out,"%s", A[get(L)]);
      //printf("printing %s to output file\n", A[get(L)]);
      moveNext(L);
   }

   
   fclose(out);

   freeList(&amp;L);
   for(i = 0; i &lt; line_count; i++){
      free(A[i]);
   }
   free(A);
</font>   return(EXIT_SUCCESS);
}</pre>
</body>
</html>
