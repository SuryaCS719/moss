<html>
<head>
<title>/fall24/gahrens/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/gahrens/pa1/Lex.c<p></p><pre>
// Name: Gabe Ahrens
// CruzID: gahrens
// Assignment: pa1
#include &lt;stdlib.h&gt;


#include "List.h"

#include &lt;string.h&gt;

#define MAX_LEN 300

<a name="1"></a><font color="#00FF00"><a href="match90-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_23.gif"/></a>

int main(int argc, char* argv[])
{
    //printf("start");

    if (argc != 3)
    {
        fprintf(stderr, "Lex.c Error: Incorrect # of arguments\n");
        exit(EXIT_FAILURE);
    }

    int line_count;
    FILE *in, *out;
    char line[MAX_LEN];


    // open files for reading and writing
    in = fopen(argv[1], "r");
    if( in==NULL )
    {
        printf("Unable to open file %s for reading\n", argv[1]);
        exit(1);
    }

    out = fopen(argv[2], "w");
</font>    if( out==NULL )
    {
        printf("Unable to open file %s for writing\n", argv[2]);
<a name="0"></a><font color="#FF0000"><a href="match90-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_68.gif"/></a>

        exit(1);
    }

    line_count = 0;
    while (fgets(line, MAX_LEN, in) != NULL)
    {
        line_count++;
//        printf("Line Count: %d\n", line_count);
    }



    char ** linesFromInput = malloc(sizeof(char*) * line_count);

    rewind(in);

    for (int i = 0; i &lt; line_count; i++)
    {
        fgets(line, MAX_LEN, in);
        linesFromInput[i] = strdup(line);
//        fprintf(stdout, "%d::%s", i, linesFromInput[i]);
//        fflush(stdout);
    }

//    fprintf(stdout, "linesFromInput[0]:%s\n", linesFromInput[0]);
//    fflush(stdout);

    List lexSortList = newList();

    // add the 0th line as a starting point for the list
    append(lexSortList, 0);

    bool inserted = false;

    // iterate through sorting rest of lines
    for (int i = 1; i &lt; line_count; i++)
    {
//        printf("i:%d\n", i);
//        fflush(stdout);

        // setup cursor
        moveFront(lexSortList);

        inserted = false;

        // compare new line idx i with lines already in list
        for (int j = 0; j &lt; length(lexSortList); j++)
        {
//            printf("j:%d\n", j);
//            fflush(stdout);

            int currentListLineIdx = get(lexSortList);


            // do comparison ***ERROR HERE***
            int compare = strcmp(linesFromInput[i], linesFromInput[currentListLineIdx]);

//            printf("cmp:%d\n", compare);
//            printf("linesFromInput[i]:%s", linesFromInput[i]);
//            printf("linesFromInput[currentListLineIdx]:%s\n", linesFromInput[currentListLineIdx]);
//            fflush(stdout);

            if ((compare &lt; 0) || (compare == 0))
            {
                // new line comes before the current list line or is the same as the current list line
                insertBefore(lexSortList, i);

                inserted = true;

                break;
            }

            // if wasn't the right spot for the new line, move to next spot in list
            moveNext(lexSortList);
        }

        // if none of the spots were right for the new line, add it to the end
        if (!inserted)
        {
            append(lexSortList, i);
        }
    }

    moveFront(lexSortList);
    while( index(lexSortList)&gt;=0 )
    {
        int currentIdxFromList = get(lexSortList);

        fprintf(out, "%s", linesFromInput[currentIdxFromList]);

        moveNext(lexSortList);
    }

    freeList(&amp;lexSortList);

    free(*linesFromInput);
    linesFromInput = NULL;

    fclose(in);
    fclose(out);

    return(0);
</font>}
</pre>
</body>
</html>
