<html>
<head>
<title>/fall24/hli347/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/hli347/pa1/Lex.c<p></p><pre>
/***
* Hugo Li
* hli347
* 2024 Fall CSE101 PA1
* Lex.c
* Reads the lines from input file, then sorts them lexicographically using List ADT, and then writes the sorted lines to output file.
***/
#include "List.h"
#include &lt;string.h&gt;

#define MAX_LENGTH 160

char* duplicateString(const char* source);

FILE *inputFile, *outputFile;
char buffer[MAX_LENGTH];
int lineCount = 0;

char* duplicateString(const char* source) {
    return strdup(source);
}

void openFiles(char* input, char* output) {
    inputFile = fopen(input, "r");
    outputFile = fopen(output, "w");

    if (inputFile == NULL) {
        fprintf(stderr, "Unable to open file %s for reading\n", input);
        exit(1);
    }

    if (outputFile == NULL) {
        fprintf(stderr, "Unable to open file %s for writing\n", output);
        exit(1);
    }
}

void countLines() {
    while (fgets(buffer, MAX_LENGTH, inputFile) != NULL) {
        lineCount++;
    }
    rewind(inputFile);
}

void populateArray(char** strArray) {
    for (int i = 0; i &lt; lineCount; i++) {
        fgets(buffer, MAX_LENGTH, inputFile);
        strArray[i] = duplicateString(buffer);
        if (strArray[i] == NULL) {
            fprintf(stderr, "Memory allocation failed\n");
            exit(1);
        }
    }
}

void sortLines(char** strArray, List list) {
<a name="0"></a><font color="#FF0000"><a href="match226-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_10.gif"/></a>

    for (int i = 0; i &lt; lineCount; i++) {
        char* temp = strArray[i];
        moveFront(list);

        while (index(list) &gt;= 0 &amp;&amp; strcmp(temp, strArray[get(list)]) &gt; 0) {
            moveNext(list);
        }

        if (index(list) == -1) {
</font>            append(list, i);
        } else {
            insertBefore(list, i);
        }
    }
}

<a name="1"></a><font color="#00FF00"><a href="match226-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_8.gif"/></a>

void writeSortedLines(char** strArray, List list) {
    moveFront(list);
    while (index(list) &gt;= 0) {
        fprintf(outputFile, "%s", strArray[get(list)]);
        moveNext(list);
    }
}

void cleanupMemory(char** strArray, List* list) {
</font>    for (int i = 0; i &lt; lineCount; i++) {
        free(strArray[i]);
    }
    free(strArray);
    freeList(list);
    fclose(inputFile);
    fclose(outputFile);
}

int main(int argc, char* argv[]) {
    if (argc != 3) {
        fprintf(stderr, "Usage: %s &lt;input file&gt; &lt;output file&gt;\n", argv[0]);
        exit(1);
    }

    openFiles(argv[1], argv[2]);
    countLines();

    char** stringArray = malloc(lineCount * sizeof(char*));
    if (stringArray == NULL) {
        fprintf(stderr, "Memory allocation failed\n");
        exit(1);
    }

    populateArray(stringArray);
    List sortedList = newList();
    
    for (int i = 0; i &lt; lineCount; i++) {
        append(sortedList, i);
    }

    clear(sortedList);
    sortLines(stringArray, sortedList);
    writeSortedLines(stringArray, sortedList);
    cleanupMemory(stringArray, &amp;sortedList);

    return 0;
}

</pre>
</body>
</html>
