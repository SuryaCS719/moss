<html>
<head>
<title>/fall24/ameloeli/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/ameloeli/pa1/Lex.c<p></p><pre>
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdbool.h&gt;
#include &lt;string.h&gt;
#include "../pa1/List.h"

int main(int argc, char *argv[])
{
    int linecount = 0;
    FILE *in, *out;
    char line[300];
    if (argc != 3)
    {
<a name="1"></a><font color="#00FF00"><a href="match133-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_17.gif"/></a>

      fprintf(stderr, "Usage: %s &lt;input file&gt; &lt;output file&gt;\n", argv[0]);
      exit(EXIT_FAILURE);
    }
    in = fopen(argv[1], "r");
    if (in == NULL)
    {
      printf("Unable to open file %s for reading\n", argv[1]);
      exit(EXIT_FAILURE);
    }
    out = fopen(argv[2], "w");
    if (out == NULL)
    {
      printf("Unable to open file %s for writing\n", argv[2]);
</font>      exit(EXIT_FAILURE);
    }
    List LexList = newList();
    append(LexList, 0);
    char **lines = malloc(linecount * sizeof(char *));
<a name="2"></a><font color="#0000FF"><a href="match133-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_12.gif"/></a>

    while (fgets(line, 300, in) != NULL)
    {
      linecount++;
      lines = realloc(lines, linecount * sizeof(char *));
      lines[linecount-1] = malloc((strlen(line) + 1) * sizeof(char));
      strcpy(lines[linecount-1], line);
</font>      if (linecount != 1)
      {
         for (moveFront(LexList); index(LexList) &gt;= 0; moveNext(LexList))
         {
            if (strcmp(lines[linecount-1], lines[back(LexList)]) &gt;= 0) {
               append(LexList, linecount-1);
               break;
            }
            else if (strcmp(lines[linecount-1], lines[front(LexList)]) &lt;= 0) {
               prepend(LexList, linecount-1);
               break;
            }
<a name="0"></a><font color="#FF0000"><a href="match133-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_18.gif"/></a>

            if ((strcmp(lines[linecount-1], lines[get(LexList)]) &lt;= 0)) {
               insertBefore(LexList, linecount-1);
               break;
            }
         }
      }
    }
    
    for (moveFront(LexList); index(LexList) &gt;= 0; moveNext(LexList))
    {
      fprintf(out, "%s", lines[get(LexList)]);
    }
    clear(LexList);
    freeList(&amp;LexList);
    for (int i = 0; i &lt; linecount; i++)
</font>    {
      free(lines[i]);
    }
    free(lines);
    fclose(in);
    fclose(out);
    return (0);
}</pre>
</body>
</html>
