<html>
<head>
<title>/fall24/rperson/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/rperson/pa1/Lex.c<p></p><pre>
/***
* Rohan Person
* rperson
* 2024 Fall CSE101 PA1
* Lex.c
* Sorting program using List ADT
***/ 

#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include "List.h"

#define maxStrings 1000
#define maxLength 300

<a name="0"></a><font color="#FF0000"><a href="match18-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_99.gif"/></a>

int main(int argc, char *argv[]) {
    // ---------------------------- READ FILE
    // CHECK LEX ARGUMENTS
    if (argc != 3) {
        printf("Attempted Lex() without both input and output file names only.\n");
        exit(EXIT_FAILURE);
    }
    
    FILE *inFile = fopen(argv[1], "r");
    
    if (inFile == NULL) {
        printf("Attempted Lex() on an invalid input file.\n");
        exit(EXIT_FAILURE);
    }
    
    
    char string[maxLength];
    int n = 0;
    
    char **fakeFile;
    
    
    while (fgets(string, maxLength, inFile) != NULL) {
        n++;
    }
    //printf("%d\n", n);
    
    fakeFile = (char **)malloc(n*sizeof(char *));
    
    if (n &gt; maxStrings) {
            printf("Attempted Lex() on a file with more than %d strings.\n", maxStrings);
            fclose(inFile);
            exit(EXIT_FAILURE);
        }
    
    rewind(inFile);
    
    int kk = 0;
    
    while (fgets(string, maxLength, inFile) != NULL) {
        //string[strcspn(string, "\n")] = '\0';
        
        fakeFile[kk] = (char *)malloc(strlen(string)+1);
        strcpy(fakeFile[kk],string);
        kk++;
        
    }
    
    fclose(inFile);
    
    
    
    /*
    // COUNT LINES IN FILE, MALLOC STRING ARRAY AND STORE LINES
    
    int n = 5;
    
    char **fakeFile;
    
    // malloc for pointer to (string pointer))
    fakeFile = malloc(n*sizeof(char *));
    
    // fo l r f g
    
    // malloc for each string pointer
    char* string = "h";
    int strlength = strlen(string);
    fakeFile[0] = malloc(strlength*sizeof(char));
    strcpy(fakeFile[0],string);
    string = "k";
    strlength = strlen(string);
    fakeFile[1] = malloc(strlength*sizeof(char));
    strcpy(fakeFile[1],string);
    string = "z";
    strlength = strlen(string);
    fakeFile[2] = malloc(strlength*sizeof(char));
    strcpy(fakeFile[2],string);
    
    string = "ho";
    strlength = strlen(string);
    fakeFile[3] = malloc(strlength*sizeof(char));
    strcpy(fakeFile[3],string);
    string = "a";
    strlength = strlen(string);
    fakeFile[4] = malloc(strlength*sizeof(char));
    strcpy(fakeFile[4],string);
         */
    
    /*
        [one] [two] [three] [four] [five]

        [one] [   ] [three] [four] [five]    index: 2
        [one] [two] [three] [four] [five]
        [one] [two] [     ] [four] [five]    index: 3
        [one] [     ] [two] [four] [five]    index: 3
        [one] [three] [two] [four] [five]
        [one] [three] [two] [    ] [five]    index: 4
        [one] [three] [    ] [two] [five]    index: 4
        [one] [    ] [three] [two] [five]    index: 4
        [    ] [one] [three] [two] [five]    index: 4
        [four] [one] [three] [two] [five]
        [four] [one] [three] [two] [    ]    index: 5
        [four] [one] [three] [    ] [two]    index: 5
        [four] [one] [    ] [three] [two]    index: 5
        [four] [    ] [one] [three] [two]    index: 5
        [    ] [four] [one] [three] [two]    index: 5
        [five] [four] [one] [three] [two]
     */
    
    /*
        [0] [1] [2] [3] [4]
        [0] [ ] [2] [3] [4]     index: 2
        [0] [1] [2] [3] [4]
        [0] [1] [ ] [3] [4]     index: 3
        [0] [ ] [1] [3] [4]     index: 3
        [0] [2] [1] [3] [4]
        [0] [2] [1] [ ] [4]     index: 4
        [0] [2] [ ] [1] [4]     index: 4
        [0] [ ] [2] [1] [4]     index: 4
        [ ] [0] [2] [1] [4]     index: 4
        [3] [0] [2] [1] [4]
        [3] [0] [2] [1] [ ]     index: 5
        [3] [0] [2] [ ] [1]     index: 5
        [3] [0] [ ] [2] [1]     index: 5
        [3] [ ] [0] [2] [1]     index: 5
        [ ] [3] [0] [2] [1]     index: 5
        [4] [3] [0] [2] [1]
     */
    
    // MAKE LIST OF INDICES IN ORDER
    List listIndices = newList();
    for(int i = 0; i &lt; n; i++){
      append(listIndices, i);
   }
    
    int tempIndex;
    int cursorIndex;
    
    
    for (int temp = 1; temp &lt; n; temp++) {
        
        //printf("index: %d, ", temp+1);
        tempIndex = getFromIndex(listIndices,temp);
        //printList(stdout, listIndices);
        //printf("\n");
        
        for (int cursor = temp-1; cursor &gt;= 0; cursor--) {
            
            //printf("cursor = %d\n", cursor);
            cursorIndex = getFromIndex(listIndices,cursor);
            
            //printf("'%s' comparing with %s:\n", fakeFile[tempIndex], fakeFile[cursorIndex]);
            
            if (strcmp(fakeFile[tempIndex], fakeFile[cursorIndex])&lt;0) {
                //printf("%s &gt; %s\n", fakeFile[getFromIndex(listIndices,cursor)], fakeFile[getFromIndex(listIndices,temp)]);
                //printf("shift index\n");
                
                if (cursor &gt; 0) {
                    moveCursor(listIndices, cursor+1);
                    set(listIndices, cursorIndex);
                }
                else {
                    moveCursor(listIndices, cursor+1);
                    set(listIndices, cursorIndex);
                    moveCursor(listIndices, cursor);
                    set(listIndices, tempIndex);
                    //printf("exit loop\n");
                }
            }
            else {
                //printf("%s &gt; %s\n", fakeFile[getFromIndex(listIndices,temp)], fakeFile[getFromIndex(listIndices,cursor)]);
                //printf("exit loop\n");
                
                moveCursor(listIndices, cursor+1);
                set(listIndices, tempIndex);
                //printList(stdout, listIndices);
                //printf("\n");
                moveFront(listIndices);
                // printList(stdout, listIndices);
                /*
                while (index(listIndices)&gt;=0) {
                    fprintf(stdout,"%s ", fakeFile[get(listIndices)]);
                    moveNext(listIndices);
                }
                moveFront(listIndices);
                printf("\n");*/
                break;
            }
            //printList(stdout, listIndices);
            //printf("\n");
            moveFront(listIndices);
            // printList(stdout, listIndices);
            /*
            while (index(listIndices)&gt;=0) {
                fprintf(stdout,"%s ", fakeFile[get(listIndices)]);
                moveNext(listIndices);
            }
            moveFront(listIndices);
            printf("\n");*/
        }
    }
    
    
    /* PROBABLY BAD METHOD
    
    // ---------------------------- ORDER LIST
    // MAKE LIST OF INDICES IN ORDER
    List listIndices = newList();
    for(int i=0; i&lt;n; i++){
      append(listIndices,i);
   }
    printList(stdout,listIndices);
    
    // RUN INSERTION SORT USING get() OF LIST ON ARRAY TO COMPARE USING strcmp()
    // start at index 1 (second in list)
    moveFront(listIndices);
    moveNext(listIndices);
    // save element in a temp
    int temp = get(listIndices);
    // save value in string array associated with index (temp)
    char* tempString = malloc(strlen(fakeFile[temp])*sizeof(char));
    strcpy(tempString,fakeFile[temp]);
    // compare saved string with strings to the left of it
    int temp2;
    if (strcmp(tempString, fakeFile[temp-1])&gt;0) {
    // if new string is greater (Z&gt;A) than saved, shift new right
        movePrev(listIndices);
        temp2 = get(listIndices);
        moveNext(listIndices);
        set(listIndices, temp2);
        movePrev(listIndices);
        set(listIndices, temp);
        moveNext(listIndices);
    }
    free(*tempString);
    
    // start at index 2 (third in list)
    moveNext(listIndices);
    // save element in a tep
    temp = get(listIndices);
    // save value in string array associated with index (temp)
    char* tempString = malloc(strlen(fakeFile[temp])*sizeof(char));
    strcpy(tempString,fakeFile[temp]);
    //c compare saved string with strings to the left of it
    if (strcmp(tempString, fakeFile[temp-1])&gt;0) {
    // if new string is greater (Z&gt;A) than saved, shift new right
        movePrev(listIndices);
        temp2 = get(listIndices);
        moveNext(listIndices);
        set(listIndices, temp2);
        movePrev(listIndices);
        set(listIndices, temp);
    }
    free(tempString);
    
    
    
    
    printf("\n");
    printList(stdout, listIndices);
    printf("\n");
    */
    
    // ---------------------------- WRITE FILE
    // USING get() OF LIST, PRINT ARRAY VALUES IN ORDER TO OUTPUT FILE
    
    FILE *outFile = fopen(argv[2], "w");
    
    moveFront(listIndices);
    //printList(stdout, listIndices);
    while (index(listIndices)&gt;=0) {
        fprintf(outFile,"%s", fakeFile[get(listIndices)]);
        fakeFile[get(listIndices)] = NULL;
        free(fakeFile[get(listIndices)]);   
        moveNext(listIndices);
    }
    
    fclose(outFile);
    
    for (int ii = 0; ii &lt; n; ii++) {
        fakeFile[ii] = NULL;
        free(fakeFile[ii]);
    }
    free(fakeFile);
</font>    
    // ------------------------------------------------------------------------
}</pre>
</body>
</html>
