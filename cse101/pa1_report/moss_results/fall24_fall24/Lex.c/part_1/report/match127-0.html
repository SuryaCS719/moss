<html>
<head>
<title>/fall24/kalimora/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/kalimora/pa1/Lex.c<p></p><pre>
// File: Lex.c
// Author: Kaylee Morales
// CruzID: kalimora
// Assignment: pa1

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include "List.h"

#define MAX_LEN 160 // Maximum length of a line to be read from the file

int main(int argc, char *argv[]) {
    // Check if the correct number of command line arguments are provided
    if (argc != 3) {
        fprintf(stderr, "Usage: %s &lt;input file&gt; &lt;output file&gt;\n", argv[0]);
        exit(1); // Exit with error if incorrect number of arguments
    }

    // Open the input file in read mode
    FILE *in = fopen(argv[1], "r");
    if (in == NULL) { 
        // Error if the file can't be opened
        fprintf(stderr, "Error: Unable to open file %s for reading\n", argv[1]);
        exit(1);
    }

    // Open the output file in write mode
<a name="0"></a><font color="#FF0000"><a href="match127-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_68.gif"/></a>

    FILE *out = fopen(argv[2], "w");
    if (out == NULL) {
        // Error if the file can't be opened for writing
        fprintf(stderr, "Error: Unable to open file %s for writing\n", argv[2]);
        exit(1);
    }

    // First, count the number of lines in the input file
    char line[MAX_LEN];
    int lineCount = 0;
    while (fgets(line, MAX_LEN, in) != NULL) {
        lineCount++;  // Increment line count for each line in the file
    }

    // Allocate memory for the array of strings, one per line in the file
    rewind(in);  // Rewind the file pointer back to the beginning of the file
    char **lines = calloc(lineCount, sizeof(char *));
    for (int i = 0; i &lt; lineCount; i++) {
        lines[i] = calloc(MAX_LEN, sizeof(char));  // Allocate space for each line
        fgets(lines[i], MAX_LEN, in);  // Read the line from the file
    }

    // Create a List to hold the indices of the lines in sorted order
    List list = newList();
    append(list, 0);  // Add the first line index (0) to the list

    // Implement an indirect Insertion Sort to arrange indices in lexicographic order
    for (int i = 1; i &lt; lineCount; i++) {
        moveFront(list);  // Start from the beginning of the list

        // Loop through the list to find the correct position for the new index
        while (index(list) != -1) {
            int idx = get(list);
            if (strcmp(lines[i], lines[idx]) &lt; 0) {
                insertBefore(list, i);  // Insert in correct position
                break;
            }
            moveNext(list);
        }

        // If we reach the end of the list, append the new index at the end
        if (index(list) == -1) {
            append(list, i);
        }
    }

    // Use the sorted list of indices to print the lines in lexicographic order
    moveFront(list);
    while (index(list) != -1) {
        fprintf(out, "%s", lines[get(list)]);  // Output sorted lines
        moveNext(list);
    }

    // Free the allocated memory for lines
    for (int i = 0; i &lt; lineCount; i++) {
</font>        free(lines[i]);
    }
    free(lines);  // Free the array of line pointers

    // Free the List and close the files
    freeList(&amp;list);
    fclose(in);
    fclose(out);

    return 0;
}

</pre>
</body>
</html>
