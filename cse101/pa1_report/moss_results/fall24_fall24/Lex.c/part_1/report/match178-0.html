<html>
<head>
<title>/fall24/dnocera/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/dnocera/pa1/Lex.c<p></p><pre>
/*
Diego Nocera 
dnocera
Pa1
*/


#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include "List.h"

#define MAX_LINE_LENGTH 256

void usage(const char* progName) {
    fprintf(stderr, "Error: Incorrect usage, &lt;input file&gt; &lt;output file&gt; in Lex\n");
    exit(EXIT_FAILURE);
}

int main(int argc, char* argv[]) {
    if (argc != 3) {
        usage(argv[0]);
    }

    FILE* inputFile = fopen(argv[1], "r");
    if (inputFile == NULL) {
        perror("Error: Opening input file in Lex");
        exit(EXIT_FAILURE);
    }

    int lineCount = 0;
    char line[MAX_LINE_LENGTH];

<a name="0"></a><font color="#FF0000"><a href="match178-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_17.gif"/></a>

    while (fgets(line, sizeof(line), inputFile)) {
        lineCount++;
    }

    char** stringArray = malloc(lineCount * sizeof(char*));
    if (stringArray == NULL) {
        fprintf(stderr, "Error: Allocating memory for string array in Lex\n");
        fclose(inputFile);
        exit(EXIT_FAILURE);
    }

    rewind(inputFile);
    for (int i = 0; i &lt; lineCount; i++) {
        fgets(line, sizeof(line), inputFile);
        line[strcspn(line, "\n")] = 0;
</font>        stringArray[i] = malloc(strlen(line) + 1);
<a name="1"></a><font color="#00FF00"><a href="match178-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_13.gif"/></a>

        if (stringArray[i] == NULL) {
            fprintf(stderr, "Error: Allocating memory for string in Lex\n");
            fclose(inputFile);
            exit(EXIT_FAILURE);
        }
        strcpy(stringArray[i], line);
    }

    fclose(inputFile);

    List indexList = newList();
    for (int i = 0; i &lt; lineCount; i++) {
        moveFront(indexList);
</font>        while (index(indexList) != -1 &amp;&amp; strcmp(stringArray[get(indexList)], stringArray[i]) &lt; 0) {
            moveNext(indexList);
        }
        if (index(indexList) == -1) {
            append(indexList, i);
        } else {
            insertBefore(indexList, i);
        }
    }

    FILE* outputFile = fopen(argv[2], "w");
    if (outputFile == NULL) {
        perror("Error: Opening output file in Lex");
        freeList(&amp;indexList);
        for (int i = 0; i &lt; lineCount; i++) {
            free(stringArray[i]);
        }
        free(stringArray);
        exit(EXIT_FAILURE);
    }

    moveFront(indexList);
    while (index(indexList) != -1) {
        fprintf(outputFile, "%s\n", stringArray[get(indexList)]);
        moveNext(indexList);
    }

    fclose(outputFile);
    freeList(&amp;indexList);
    for (int i = 0; i &lt; lineCount; i++) {
        free(stringArray[i]);
    }
    free(stringArray);

    return 0;
}

</pre>
</body>
</html>
