<html>
<head>
<title>/fall24/nkamath/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/nkamath/pa1/Lex.c<p></p><pre>
/*************************************
 * Nivedita Kamath
 * nkamath
 * 2024 Fall CSE 101 PA1
 * Lex.c
 * Main function that takes in a input 
 * file and output file, reads from the
 * input file and writes the sorted
 * contents of the input file into 
 * the output file.
 *************************************/
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include "List.h"

#define MAX_LEN 300 // Maximum length for each line

int main(int argc, char *argv[]) {

    if(argc != 3) { // checking command line for correct number of arguments
        fprintf(stderr, "Usage: %s &lt;input file&gt; &lt;output file&gt;/n", argv[0]);
        exit(1);
    }

    FILE *in = fopen(argv[1], "r"); // Opening input file for reading
    if (in == NULL) { // checking if file is NULL
<a name="0"></a><font color="#FF0000"><a href="match97-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_76.gif"/></a>

        fprintf(stderr, "Unable to open file %s for reading\n", argv[1]);
        exit(1);
    }

    FILE *out = fopen(argv[2], "w"); // opening output file for writing
    if (out == NULL) { // checkin if file is NULL
        fclose(in); // close input file, since we won't be using it either now :(
        fprintf(stderr, "Unable to open file %s for writing\n", argv[2]);
        exit(1);
    }

    
    int n = 0; // number of indexes in input
    char buffer[MAX_LEN];
    while(fgets(buffer, MAX_LEN, in) != NULL) {
        n++;
    }
    char **input = malloc(n * sizeof(char *)); // array of input indexes size n
    if (input == NULL) {
        fprintf(stderr, "Could not allocate memory for input array");
        exit(1);
    }

    rewind(in);

    int i = 0;
    while (fgets(buffer, MAX_LEN, in) != NULL) { // check that next input index exits
        buffer[strcspn(buffer, "\n")] = '\0'; // removing enter new line character
        input[i] = malloc((strlen(buffer) + 1) * sizeof(char));
        if(input[i] == NULL){
            fprintf(stderr, "Memory allocation failed for line %d\n", i);
            exit(1);
        }
        strcpy(input[i], buffer);
        i++;
    }

    List indexList = newList(); // Creating new list for ordered indices
    append(indexList, 0);

    for (int i = 1; i &lt; n; i++) { // iterate through each index in array
        moveFront(indexList); // start at the front of the ordered indices list
        int inserted = 0; // nothing has been inserted yet

        // Check if there are values already in the ordered list
        // check if the new index has been added to list
        while(index(indexList) != -1) { 
            if (strcmp(input[i], input[get(indexList)]) &lt; 0) { // compare with the current index in array
                // if the new index is less than the current index in the list, place the array index before the list index
                insertBefore(indexList, i); 
                inserted = 1; // flag that index has been inserted
                break;
            }
            moveNext(indexList); // move to next index in list
        }
        if(!inserted) { // if index was never inserted, it is larger than all indexes currently in list
            append(indexList, i); // place index at the end of the list
        }
    }

    moveFront(indexList);
    while(index(indexList) != -1) { // Printing to output
        fprintf(out, "%s\n", input[get(indexList)]);
        moveNext(indexList);
    }


    for (int i = 0; i&lt;n; i++) { // Freeing allocated memory
</font>        free(input[i]);
    }
    free(input);
    freeList(&amp;indexList);

    fclose(in);
    fclose(out);

    return 0;
}
</pre>
</body>
</html>
