<html>
<head>
<title>/fall24/atruji13/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/atruji13/pa1/Lex.c<p></p><pre>
#define _GNU_SOURCE
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include "List.h"

int main(int argc, char* argv[]) {
	// Check if # of command-line args is correct
	if (argc != 3) {
		fprintf(stderr, "Usage: %s &lt;input file&gt; &lt;output file&gt;\n", argv[0]);
		return EXIT_FAILURE;
	}

	// Open input and output files
	FILE* in = fopen(argv[1], "r");
<a name="0"></a><font color="#FF0000"><a href="match147-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_49.gif"/></a>

	FILE* out = fopen(argv[2], "w");
	
	if (in == NULL || out == NULL) {
		fprintf(stderr, "Error: couldn't open file(s)\n");
		return EXIT_FAILURE;
	}

	// Store lines in dynamic array of strings
	char** lines = NULL;
	int lineCount = 0;
	size_t lineCap = 0; // Cap for getline (resizes automatically)
	char* line = NULL; // Buffer to hold each line during reading

	// Reach each line from the file
	while (getline(&amp;line, &amp;lineCap, in) != -1) {
		// Resize array for new line
		lines = realloc(lines, sizeof(char*) * (lineCount + 1));
		//Duplicate line
		lines[lineCount] = strdup(line);
		lineCount++;
	}
	free(line); // Free temp buffer used by getline

	// Craete new list to store the indices of the lines in sorted order
	List list = newList();

	for (int i = 0; i &lt; lineCount; i++) {
		moveFront(list);
		
		// Move through list until correct position found
		while (index(list) &gt;= 0 &amp;&amp; strcmp(lines[get(list)], lines[i]) &lt;= 0) {
</font>			moveNext(list);
		}
	
		// Reach end of list? -&gt; append the index
		if (index(list) == -1) {
			append(list, i); // Insert index at the end
		} else {
			insertBefore(list, i); // Insert before the current cursor position
		}
	}

	// Since indices are sorted, print corresponding lines to output
	moveFront(list);
	while(index(list) &gt;= 0) {
		fprintf(out, "%s", lines[get(list)]); // Print line @ curr. ind.
		moveNext(list);
	}

	// Free dynamically allocated mem
	for (int i = 0; i &lt; lineCount; i++) {
		free(lines[i]);
	}
	free(lines); // Free array
	freeList(&amp;list); // Free list ADT

	fclose(in);
	fclose(out);

	return EXIT_SUCCESS;
}
</pre>
</body>
</html>
