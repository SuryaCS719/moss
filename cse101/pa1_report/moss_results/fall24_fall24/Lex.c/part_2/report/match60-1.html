<html>
<head>
<title>/fall24/mjokoro/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/mjokoro/pa1/Lex.c<p></p><pre>
// ---------------------------------------------------
// Lex.c
// Takes two command line arguments giving the names of an input file and output file,
// creates a List that indirectly sorts the input in lexicographic order, and
// formats the contents of input file into the output file in sorted order
// 
// Name: Munachi Okoro
// CruzID: mjokoro
// Assignment: pa1
// ---------------------------------------------------

#include "List.h"
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

// had to make my own strdup since it is not working, perhaps due to 'std=c16' in Makefile

<a name="0"></a><font color="#FF0000"><a href="match60-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_99.gif"/></a>

char* strdup(char* string) {
    size_t length = strlen(string) + 1;   
    char* copy = calloc(length, sizeof(char));      
    if (copy != NULL) {
        strcpy(copy, string);          
    }
    return copy;
}

int main(int argc, char* argv[]){
        //check the correct number of elements
        if(argc != 3){
                fprintf(stderr, "Lex error: number of command line arguments does not equal 2.\n");
                exit(EXIT_FAILURE);
        }
        FILE* input = fopen(argv[1], "r");
        if(input == NULL){
                fprintf(stderr, "Lex error: trying to open NULL input file reference.\n");
                exit(EXIT_FAILURE);
        }
        FILE* output = fopen(argv[2], "w");
        if(input == NULL){
                fprintf(stderr, "Lex error: trying to open NULL output file reference.\n");
                exit(EXIT_FAILURE);
        }

        //get the line count
        int line_count = 0;
        char buffer[300];
        while( fgets(buffer, 300, input ) ){
               line_count++;
        }

        //make and allocate an array of the strings
        char** strings = calloc(line_count, sizeof(char*));
        rewind(input);
        int i = 0;
        while( fgets(buffer, 300, input ) ){
               buffer[strcspn(buffer, "\n")] = '\0'; //remove the newline
               strings[i] = strdup(buffer); //add the string (allocated using strdup) to strings array
               i++;
        }

        //create a list where the elements/data of each node is the index of each string
        //insert each node in lexographic order
        List L = newList();
        for(int i = 0; i&lt;line_count; i++){
                char* currentString = strings[i]; //current string is being used

                //place the node in lexographic order
                if(i == 0){ // just append it if there are no other nodes
			append(L, i);
                }
		else{
                	moveFront(L); // otherwise, moveFront and do insertion method
			while( index(L) != -1 &amp;&amp; strcmp( currentString, strings[get(L)] ) &gt; 0) { // 'while the string we're trying to insert &gt; string indicated by cursor..
				moveNext(L); //move to the next one
                	}

                	//handle when cursor falls off
                	if(index(L) == -1){
                        	append(L,i);

                	}
                	else{
                        	insertBefore(L, i);
			}	
		}
        }

	//now we have List, and just need to put them into output file in that order. 
	moveFront(L);
	for(int i = 0; i&lt;line_count; i++){
		fprintf(output, "%s\n", strings[get(L)]);
		moveNext(L);
	}

	//free strings
	for(int i = 0; i&lt;line_count; i++){
		free(strings[i]);
	}
	free(strings);


        fclose(input);
        fclose(output);
	freeList(&amp;L);	
	return 0;
</font>}
</pre>
</body>
</html>
