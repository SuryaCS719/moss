<html>
<head>
<title>/fall24/felaguna/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/felaguna/pa1/Lex.c<p></p><pre>
/***
* Fernando Laguna
* felaguna 
* 2024 Fall CSE101 PA1  
* Lex.c 
* Takes in two files (input and output) arranges output file in lexicographic order
***/ 



#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt; 
#include &lt;string.h&gt;
#include "List.h"


<a name="0"></a><font color="#FF0000"><a href="match2-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_98.gif"/></a>

int line_counter(FILE* inputFile) { 
	int count = 0;
	char ch; 
	while ((ch = fgetc(inputFile)) != EOF) { 
		if (ch == '\n')  { 
			count += 1; 
		}
	}
	rewind(inputFile); 
	return count; 
}

char **read_lines(FILE* inputFile, int number) { 
	char **lines = malloc( number * sizeof(char*)); 
	if (!lines) { 
		perror("Failed");
		exit(EXIT_FAILURE);
	}
	char buffer[1024];
	for (int i = 0;i &lt; number; i++) { 
		if(fgets(buffer,sizeof(buffer),inputFile) != NULL) { 
			lines[i] = malloc(strlen(buffer) + 1);
		        if (!lines[i]) {
				perror("Failure"); 
				exit(EXIT_FAILURE);
			}
			strcpy(lines[i],buffer);
		}
	}
	return lines; 
}

int string_comparison(const void *first, const void *second) { 
	return strcmp(*(const char **)first,*(const char **)second);
}


void sort_lines(char **lines,int lineCount) {
	int *indices = malloc(lineCount * sizeof(int));
	if (!indices) {
		perror("Failure"); 
		exit(EXIT_FAILURE); 
	}

	for (int i = 0; i &lt; lineCount; i++) { 
		indices[i] = i; 
	}

	qsort(lines,lineCount,sizeof(char*),string_comparison);

	char **sorted_lines = malloc(lineCount * sizeof(char *)); 
	for (int i = 0; i &lt; lineCount;i++) {
		sorted_lines[i] = lines[indices[i]];
	}

	for (int i = 0; i &lt; lineCount; i++) {
		lines[i] = sorted_lines[i];
	}
	free(indices);
	free(sorted_lines);
}

int main(int argc, char *argv[]) { 

	if (argc != 3) { 
		fprintf(stderr, "Usage: %s &lt;file1&gt; &lt;file2&gt;\n",argv[0]); 
		exit(EXIT_FAILURE); 
	}


	FILE *inputFile = fopen(argv[1],"r"); 
	if(inputFile == NULL) { 
		perror("Error"); 
		exit(EXIT_FAILURE); 
	}
	
	FILE *outputFile = fopen(argv[2],"w");
        if(outputFile == NULL) {
                perror("Error");
		fclose(inputFile);
                exit(EXIT_FAILURE);
        }


	int lineCount = line_counter(inputFile); 
	if (lineCount == 0) { 
		fprintf(stderr,"No lines"); 
		fclose(inputFile);
		fclose(outputFile);
		exit(EXIT_FAILURE);
	}			
	char **lines = read_lines(inputFile,lineCount); 
	fclose(inputFile);

	
	sort_lines(lines,lineCount);

	for (int i = 0; i &lt; lineCount; i++) { 
		fprintf(outputFile,"%s",lines[i]);
	}

	for (int i = 0; i &lt; lineCount; i++) {
		free(lines[i]); 
	}
	free(lines); 
</font>
	fclose(outputFile);

	return 0; 
}
</pre>
</body>
</html>
