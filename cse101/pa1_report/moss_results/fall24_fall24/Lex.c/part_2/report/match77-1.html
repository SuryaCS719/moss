<html>
<head>
<title>/fall24/ncheblok/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/ncheblok/pa1/Lex.c<p></p><pre>
#include "stdio.h"
#include "List.h"

#include &lt;string.h&gt;

<a name="0"></a><font color="#FF0000"><a href="match77-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_98.gif"/></a>

int main(int argc, char** argv)
{
    if(argc == 2)
    {
        printf("Output file path not specified\r\n\n\t %s %s &lt;output filepath&gt;\r\n", argv[0], argv[1]);
        return -1;
    }
    if(argc == 1)
    {
        printf("Input and output file not specified\r\n\n\t %s &lt;input filepath&gt; &lt;output filepath&gt;\r\n", argv[0]);
        return -1;
    }

    FILE* pInFile = fopen(argv[1], "r");
    FILE* pOutFile = fopen(argv[2], "w");

    fseek(pInFile, 0L, SEEK_END);
    unsigned int size = ftell(pInFile);
    fseek(pInFile, 0L, SEEK_SET);

    char* word = malloc(size);
    unsigned int maxSize = 0;
    unsigned int totalLines = 0;
    while(fgets(word, size, pInFile))
    {
        totalLines ++;
        unsigned int len = strlen(word);
        if(maxSize &lt; len) maxSize = len;
    }
    free(word);
    if(!totalLines)
    {
        printf("Input file is empty\r\n");
        return -1;
    }

    char buf[totalLines][maxSize+1];
    fseek(pInFile, 0L, SEEK_SET);

    List indices = newList();

    fgets(buf[0], maxSize+1, pInFile);
    append(indices, 0);
    unsigned int idx = 1;
    while(fgets(buf[idx], maxSize+1, pInFile))
    {
        moveFront(indices);
        while(strcmp(buf[idx], buf[get(indices)]) &gt; 0)
        {
            moveNext(indices);
            if(index(indices) == -1)
            {
                append(indices, idx);
                break;
            }
        }
        if(index(indices) != -1)
        {
            insertBefore(indices, idx);
        }
        idx++;
    }
    fclose(pInFile);

    moveFront(indices);
    for(int i = 0; i &lt; totalLines; i++)
    {
        fprintf(pOutFile, "%s", buf[get(indices)]);
        printf("%s", buf[get(indices)]);
        moveNext(indices);
    }
    fclose(pOutFile);
</font>    freeList(&amp;indices);
}
</pre>
</body>
</html>
