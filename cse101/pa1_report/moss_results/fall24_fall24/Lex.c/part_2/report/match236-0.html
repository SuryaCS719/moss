<html>
<head>
<title>/fall24/bwang96/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/bwang96/pa1/Lex.c<p></p><pre>
//-----------------------------------------------------------------------------
// 2024 Fall CSE101 pa1
// Lex.c
// Lex.c accepts two command line arguments: the names of an input file and an output file. 
// The input file can be any text file, and the output file will contain the same lines as the input, 
// but sorted in lexicographical (alphabetical) order.
// Brendan Wang
// bwang96@ucsc.edu
//-----------------------------------------------------------------------------
#include&lt;stdio.h&gt;
#include&lt;stdlib.h&gt;
#include&lt;stdbool.h&gt;
#include&lt;string.h&gt;
#include"List.h"

#define MAX_LEN 300


int compareStrings(const char *a, const char *b) { // compares two strings
    return strcmp(a, b);
}

void swapStrings(char **a, char **b) { // swaps two strings
    char *temp = *a;
    *a = *b;
    *b = temp;
}

char *strdup(const char *str) { // dupes the strings
    int j = strlen(str) + 1;
    char *dup = malloc(j);
    if(dup) {
        strcpy(dup, str);
    }
    return dup;
}

<a name="0"></a><font color="#FF0000"><a href="match236-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_8.gif"/></a>

int main(int argc, char * argv[]){

   int line_count = 0;
   FILE *in, *out;
   char line[MAX_LEN];

   if ( argc != 3 ){    // check command line for num of arguments
      fprintf(stderr, "Usage: %s &lt;input file&gt; &lt;output file&gt;\n", argv[0]);
</font>      exit(EXIT_FAILURE);
   }

   in = fopen(argv[1], "r");  // open files for read and write
      if ( in==NULL ){
      fprintf(stderr, "Unable to open file %s for reading\n", argv[1]);
      exit(1);
   }


<a name="1"></a><font color="#00FF00"><a href="match236-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_8.gif"/></a>

   out = fopen(argv[2], "w");
   if ( out==NULL ){
      fprintf(stderr, "Unable to open file %s for writing\n", argv[2]);
      exit(1);
   }

   while ( fgets(line, MAX_LEN, in) != NULL)  {    // read each line of input file
</font>      line_count++;
   }

    rewind(in);    // goes back to top of file
    

    char **lines = (char **)malloc(line_count * sizeof(char *));  // allocates memory for array lines
    if (lines == NULL) {
        perror("Memory allocation failed");
        fclose(in);
        fclose(out);
        exit(EXIT_FAILURE);
    }

    for (int i = 0; i &lt; line_count; i++) { // read each line of input file then stores in lines array
        if (fgets(line, MAX_LEN, in) != NULL) {
            size_t length = strlen(line); // removes newline char at tend of line
            if (length &gt; 0 &amp;&amp; line[length - 1] == '\n') {
                line[length - 1] = '\0';
            }

            lines[i] = strdup(line); // allocate memory for line and copy into lines array
            if (lines[i] == NULL) {
                perror("Memory allocation failed");
                for (int j = 0; j &lt; i; j++) {
                    free(lines[j]);
                }
                free(lines);
                fclose(in);
                fclose(out);
                exit(EXIT_FAILURE);
            }
        }
    }
    

    for (int i = 0; i &lt; line_count - 1; i++) { // bubble sort to sort lines array alphabetically
        for (int j = 0; j &lt; line_count - i - 1; j++) {
            if (compareStrings(lines[j], lines[j + 1]) &gt; 0) {
                swapStrings(&amp;lines[j], &amp;lines[j + 1]);
            }
        }
    }
    
    for (int i = 0; i &lt; line_count; i++) { // print sorted lines to output file
        fprintf(out, "%s\n", lines[i]);
    }
    
    for (int i = 0; i &lt; line_count; i++) { // free memory
        free(lines[i]);
    }
   
    free(lines);
   
    // close files 
    fclose(in);
    fclose(out);
    return(0);
}
    </pre>
</body>
</html>
