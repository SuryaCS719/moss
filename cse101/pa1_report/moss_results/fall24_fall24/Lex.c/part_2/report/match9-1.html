<html>
<head>
<title>/fall24/asmurthy/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/asmurthy/pa1/Lex.c<p></p><pre>
/*
 * Name: Ashwin Murthy
 * CruzID: asmurthy
 * Assignment: pa1
 */
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include "List.h"
#include &lt;string.h&gt;
#define MAX_LINE_LENGTH 1000

<a name="0"></a><font color="#FF0000"><a href="match9-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_98.gif"/></a>

void sort(List L, char** lines, int lineCount);

int main(int argc, char* argv[]) {
    if (argc != 3) {
        fprintf(stderr, "Usage: Lex &lt;input file&gt; &lt;output file&gt;\n");
        return EXIT_FAILURE;
    }

    char* inputFileName = argv[1];
    char* outputFileName = argv[2];

    FILE* inputFile = fopen(inputFileName, "r");
    if (inputFile == NULL) {
        fprintf(stderr, "Error opening input file: %s\n", inputFileName);
        return EXIT_FAILURE;
    }

    int lineCount = 0;
    char** lines = NULL;
    char line[MAX_LINE_LENGTH];

    while (fgets(line, sizeof(line), inputFile)) {
        lineCount++;
        lines = realloc(lines, lineCount * sizeof(char*));
        if (lines == NULL) {
            fprintf(stderr, "Memory allocation failed\n");
            fclose(inputFile);
            return EXIT_FAILURE;
        }
        lines[lineCount - 1] = malloc((strlen(line) + 1) * sizeof(char));
        if (lines[lineCount - 1] == NULL) {
            fprintf(stderr, "Memory allocation failed\n");
            fclose(inputFile);
            return EXIT_FAILURE;
        }
        strcpy(lines[lineCount - 1], line);
        lines[lineCount - 1][strcspn(lines[lineCount - 1], "\n")] = '\0';
    }
    fclose(inputFile);

    List indexList = newList();

    sort(indexList, lines, lineCount);

    FILE* outputFile = fopen(outputFileName, "w");
    if (outputFile == NULL) {
        fprintf(stderr, "Error opening output file: %s\n", outputFileName);
        freeList(&amp;indexList);
        return EXIT_FAILURE;
    }

    for (moveFront(indexList); indexList != NULL&amp;&amp;index(indexList)&gt;=0; moveNext(indexList)) {
        int index = get(indexList);
        fprintf(outputFile, "%s\n", lines[index]);
    }

    fclose(outputFile);

    for (int i = 0; i &lt; lineCount; i++) {
        free(lines[i]);
    }
    free(lines);
    freeList(&amp;indexList);

    return EXIT_SUCCESS;
}
void sort(List L, char** lines, int lineCount) {
    if (lineCount &lt; 2) return; 
    append(L, 0);

    for (int i = 1; i &lt; lineCount; i++) {
        int currentIndex = i;
        char* currentLine = lines[currentIndex];

        moveBack(L);
        while (index(L) &gt;= 0) {
            int compareIndex = get(L);
            if (strcmp(lines[compareIndex], currentLine) &gt; 0) {
                movePrev(L);
            } else {
                break;
            }
        }

        if (index(L) == -1) {
            prepend(L, currentIndex);
        } else {
</font>            insertAfter(L, currentIndex);
        }
    }
}
</pre>
</body>
</html>
