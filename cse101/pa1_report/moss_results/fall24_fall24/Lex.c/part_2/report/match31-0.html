<html>
<head>
<title>/fall24/sushakya/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/sushakya/pa1/Lex.c<p></p><pre>
/***
* Suramya Shakya
* sushakya
* 2024 Fall CSE101 PA1
* Lex.c
* C program that sorts them lexicographically using the List ADT
***/
#include "List.h"
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

#define MAX_LENGTH 255

<a name="0"></a><font color="#FF0000"><a href="match31-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_98.gif"/></a>

char *strdup(const char *s);

void handleError(const char *message) {
    fprintf(stderr, "%s\n", message);
    exit(EXIT_FAILURE);
}

void readLines(FILE *in, char ***lines, int *count) {
    char buffer[MAX_LENGTH];
    *count = 0;

    // First pass: count the lines
    while (fgets(buffer, sizeof(buffer), in)) {
        (*count)++;
    }

    // Allocate memory for the lines
    *lines = malloc(*count * sizeof(char *));
    if (!*lines) {
        handleError("Memory allocation failed for lines");
    }

    // Reset the file pointer and read lines again
    rewind(in);
    for (int i = 0; i &lt; *count; i++) {
        fgets(buffer, sizeof(buffer), in);
        (*lines)[i] = strdup(buffer);
        if (!(*lines)[i]) {
            handleError("Memory allocation failed for line duplication");
        }
    }
}

void writeSortedLines(FILE *out, List L, char **lines) {
    moveFront(L);
    while (index(L) &gt;= 0) {
        fprintf(out, "%s", lines[get(L)]);
        moveNext(L);
    }
}

int main(int argc, char *argv[]) {
    if (argc != 3) {
        handleError("Usage: ./Lex &lt;input file&gt; &lt;output file&gt;");
    }

    FILE *in = fopen(argv[1], "r");
    if (!in) {
        handleError("Unable to open input file");
    }

    FILE *out = fopen(argv[2], "w");
    if (!out) {
        fclose(in);
        handleError("Unable to open output file");
    }

    char **lines;
    int lineCount;
    readLines(in, &amp;lines, &amp;lineCount);

    List sortedList = newList();
    for (int i = 0; i &lt; lineCount; i++) {
        moveFront(sortedList);
        while (index(sortedList) &gt;= 0 &amp;&amp; strcmp(lines[i], lines[get(sortedList)]) &gt; 0) {
            moveNext(sortedList);
        }
        if (index(sortedList) == -1) {
            append(sortedList, i);
        } else {
            insertBefore(sortedList, i);
        }
    }

    writeSortedLines(out, sortedList, lines);

    for (int i = 0; i &lt; lineCount; i++) {
        free(lines[i]);
    }
    free(lines);
    freeList(&amp;sortedList);
    fclose(in);
    fclose(out);
</font>
    return EXIT_SUCCESS;
}

</pre>
</body>
</html>
