<html>
<head>
<title>/fall24/salwebst/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/salwebst/pa1/Lex.c<p></p><pre>
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include "List.h"

#define MAX_LINE_LENGTH 1024  // Maximum length for each line

<a name="0"></a><font color="#FF0000"><a href="match26-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_98.gif"/></a>

int main(int argc, char* argv[]) 
{
    	// Check for correct number of command line arguments
    	if (argc != 3) 
	{
        	fprintf(stderr, "Usage: Lex &lt;input file&gt; &lt;output file&gt;\n");
        	exit(EXIT_FAILURE);
    	}

    	// Open input file
    	FILE* inputFile = fopen(argv[1], "r");
    	if (inputFile == NULL) 
	{
        	fprintf(stderr, "Error: Unable to open input file %s\n", argv[1]);
        	exit(EXIT_FAILURE);
    	}

    	// Count lines in the input file
    	int lineCount = 0;
    	char buffer[MAX_LINE_LENGTH];

    	while (fgets(buffer, sizeof(buffer), inputFile) != NULL) 
	{
        	lineCount++;
    	}

    	// Allocate memory for strings
    	char** lines = malloc(lineCount * sizeof(char*));
    	if (lines == NULL) 
	{
        	fprintf(stderr, "Error: Unable to allocate memory for lines\n");
        	fclose(inputFile);
        	exit(EXIT_FAILURE);
    	}

    	// Reset file pointer to beginning and read lines into array
    	rewind(inputFile);
    	for (int i = 0; i &lt; lineCount; i++) 
	{
        	fgets(buffer, sizeof(buffer), inputFile);
        	// Remove newline character
        	buffer[strcspn(buffer, "\n")] = '\0';
        	lines[i] = malloc((strlen(buffer) + 1) * sizeof(char));
        	if (lines[i] == NULL) 
		{
            		fprintf(stderr, "Error: Unable to allocate memory for line\n");
            		fclose(inputFile);
            		exit(EXIT_FAILURE);
        	}
        	strcpy(lines[i], buffer);
    	}

   	// Close the input file
    	fclose(inputFile);

    	// Create a List to store indices
    	List indexList = newList();

    	// Insert indices using Insertion Sort
    	for (int i = 0; i &lt; lineCount; i++) 
	{
        	// Start from the front of the list
        	moveFront(indexList);
        	int position = 0;
        	// Find the correct position for the current index
        	while (indexList-&gt;cursor != NULL) 
		{
            		int j = indexList-&gt;cursor-&gt;data; // Get the index from the List
            		if (strcmp(lines[i], lines[j]) &lt; 0) 
			{ // Compare with the lines
                		break; // Found the position to insert
            		}
            		moveNext(indexList); // Move to the next index
            		position++;
        	}
        	if (position == 0) 
		{
            		prepend(indexList, i); // Insert at the front
        	
		} else {
            		insertBefore(indexList, i); // Insert before the current cursor
        	}
    	}

    	// Open the output file
    	FILE* outputFile = fopen(argv[2], "w");
    	if (outputFile == NULL) 
	{
        	fprintf(stderr, "Error: Unable to open output file %s\n", argv[2]);
        	exit(EXIT_FAILURE);
    	}

    	// Write sorted lines to the output file using indices
    	moveFront(indexList);
    	while (indexList-&gt;cursor != NULL) 
	{
        	int index = indexList-&gt;cursor-&gt;data; // Get the index from the List
        	fprintf(outputFile, "%s\n", lines[index]); // Print the line
        	moveNext(indexList); // Move to the next index
    	}

    	// Clean up: Free allocated memory and close the output file
    	for (int i = 0; i &lt; lineCount; i++) 
	{
        	free(lines[i]); // Free each line
    	}
    	free(lines); // Free the array of lines
    	freeList(&amp;indexList); // Free the List
    	fclose(outputFile);
</font>
   	return 0;
}
</pre>
</body>
</html>
