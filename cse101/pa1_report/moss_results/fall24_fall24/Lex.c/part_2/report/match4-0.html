<html>
<head>
<title>/fall24/bli312/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/bli312/pa1/Lex.c<p></p><pre>
/***
 * Leo Li
 * bli312
 * 2024 Fall CSE101 PA1
 * Lex.c
 * Using functions to sort a List in alphabetical order and return the index.
 ***/


#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include&lt;assert.h&gt;
#include&lt;stdbool.h&gt;
#include &lt;string.h&gt;
#include "List.h"
#include &lt;stdint.h&gt;



<a name="0"></a><font color="#FF0000"><a href="match4-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_99.gif"/></a>

void free_vocabulary(char **vocabulary, int num_words){
    for (int k = 0; k &lt; num_words; k++){
        free(vocabulary[k]);
    }
    free(vocabulary);
}

char** load_vocabulary(char *filename, int* num_words){
    char** out = NULL;

    FILE *infile;
    infile = fopen(filename, "r");
    if (infile == NULL){
        printf("Unable to open file %s for reading\n", filename);
        exit(1);
    }

    char buffer[1024];
    int count = 0;
    out = (char **) malloc(sizeof(char *));
    // char* word;
    
    while (fgets(buffer, 1024, infile) != NULL){
        // char *word = strdup(buffer);
        char* word = (char *)malloc(strlen(buffer)+1); // for "\0"
        if (word == NULL){
            printf("Unable to allocate memory to word\n");
            exit(1);
        }
        strcpy(word, buffer);
        
        if (word[strlen(word)-1] == '\n'){
            word[strlen(word)-1] = '\0';
        }

        count ++;
        out = (char **)realloc(out, count* sizeof(char*));
        out[count-1] = word;
        // free(word);
    }



    *num_words = count;
    printf("%d", count);
    fclose(infile);
    // free(word);
    return out;
}



int main(int argc, char* argv[]){
    // char buffer[1024];
    int index_word;
    List a = newList();
    char **vocabulary;
    int n;


// check command line for correct number of arguments
    if (argc != 3){
        printf("Usage: %s &lt;input file&gt; &lt;output file&gt;\n", argv[0]);
        exit(1);
    }


    // load the vocabulary list and update the number of words.
    vocabulary = load_vocabulary(argv[1], &amp;n);



    // char** sub = calloc(n, sizeof(char*)); // create the empty sub array


    index_word = 0;
    prepend(a, index_word);
    char* s1;
    char* s2;
    bool inserted;
    

    for (index_word = 1; index_word &lt; n; index_word++){   // for loop to go over the vocabulary
        moveFront(a);
        s1 = (vocabulary[index_word]);  // the word to insert
        
        inserted = false;

        for (int move = 0; move &lt; index_word; move++ ){  // another for loop to move the cursor and insertBefore()

            s2 = vocabulary[ (get(a)) ]; // the cursor word
            int result = strcmp(s1, s2);

            if (result &lt;= 0){
                insertBefore(a, index_word);
                // free(s1);
                // free(s2);
                inserted = true;
                break;
            }


            // if (move == ( length(a)-1) ){
            //     append(a, index_word);
            //     free(s1);
            //     free(s2);
            //     break;
            // }

            // free(s2);
            moveNext(a);
        }

        if (!inserted){
            append(a, index_word);
        }

    }

    // while (fgets(buffer, 1024, in) != NULL){
    //     index ++;
    //     if (index == 0){
    //         prepend(a, index);
    //     }

    //     moveFront(a);

    // }


    // open the file for writing
    FILE *out;
    out = fopen(argv[2], "w");
    if (out == NULL){
        printf("Unable to open file %s for writing\n", argv[2]);
        free_vocabulary(vocabulary, n);
        freeList(&amp;a);
        exit(1);
    }

    if (n==0){
        free_vocabulary(vocabulary, n);
        freeList(&amp;a); 
        fclose(out);
        return 0;
    }

    // char* last = vocabulary[n-1];
    // last[strlen(last)-1] = '\0';

    // char* temp = malloc(sizeof(char))

    // printList(out, a);
    // printList(stdout, a);

    
    for(moveFront(a); index(a) &gt;= 0; moveNext(a)){
        fprintf(out, "%s\n", vocabulary[get(a)]);
    }


    // close the out file
    fclose(out);

    free_vocabulary(vocabulary, n);
    freeList(&amp;a);  
    return 0;
</font>}</pre>
</body>
</html>
