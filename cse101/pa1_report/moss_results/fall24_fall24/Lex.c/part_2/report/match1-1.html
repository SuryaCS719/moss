<html>
<head>
<title>/fall24/jpmalik/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/jpmalik/pa1/Lex.c<p></p><pre>
//juhi malik pa1 jpmalik 


#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdbool.h&gt;
#include &lt;string.h&gt;
#include "List.h"

#define MAX_LEN 400


<a name="0"></a><font color="#FF0000"><a href="match1-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_99.gif"/></a>

void readLinesFromFile(FILE *in, char **items, long lineCount);
long countLinesInFile(FILE *in);
void sortLinesIntoList(List sorted, char **items, long lineCount);
void writeLinesToFile(FILE *out, char **items, List sorted);

int main(int argc, char *argv[])
{
    if (argc != 3)
    {
        fprintf(stderr, "Usage: %s &lt;input file&gt; &lt;output file&gt;\n", argv[0]);
        return EXIT_FAILURE;
    }

    FILE *in = fopen(argv[1], "r");
    if (!in)
    {
        fprintf(stderr, "Unable to open file %s for reading\n", argv[1]);
        return EXIT_FAILURE;
    }

    FILE *out = fopen(argv[2], "w");
    if (!out)
    {
        fprintf(stderr, "Unable to open file %s for writing\n", argv[2]);
        fclose(in);
        return EXIT_FAILURE;
    }

    long lineCount = countLinesInFile(in);
    char **items = malloc(lineCount * sizeof(char *));
    readLinesFromFile(in, items, lineCount);
    fclose(in);

    List sorted = newList();
    sortLinesIntoList(sorted, items, lineCount);
    writeLinesToFile(out, items, sorted);
    fclose(out);

    for (long i = 0; i &lt; lineCount; i++)
    {
        free(items[i]);
    }
    free(items);
    freeList(&amp;sorted);

    return EXIT_SUCCESS;
}

long countLinesInFile(FILE *in)
{
    long lineCount = 0;
    int currChar;

    while ((currChar = fgetc(in)) != EOF)
    {
        if (currChar == '\n')
        {
            lineCount++;
        }
    }
    fseek(in, 0, SEEK_SET);
    return lineCount;
}

void readLinesFromFile(FILE *in, char **items, long lineCount)
{
    char line[MAX_LEN];
    long count = 0;

    while (fgets(line, MAX_LEN, in) != NULL)
    {
        char *token = strtok(line, "\n");
        if (token == NULL)
        {
            items[count] = calloc(1, sizeof(char));
        }
        else
        {
            items[count] = malloc(strlen(token) + 1);
            strcpy(items[count], token);
        }
        count++;
    }
}

void sortLinesIntoList(List sorted, char **items, long lineCount)
{
    append(sorted, 0);

    for (long i = 1; i &lt; lineCount; i++)
    {
        char *item = items[i];
        moveFront(sorted);

        while (index(sorted) &gt;= 0)
        {
            int j = get(sorted);
            if (strcmp(item, items[j]) &lt; 0)
            {
                insertBefore(sorted, i);
                break;
            }
            moveNext(sorted);
        }

        if (index(sorted) == -1)
        {
            append(sorted, i);
        }
    }
}

void writeLinesToFile(FILE *out, char **items, List sorted)
{
    moveFront(sorted);
    while (index(sorted) &gt;= 0)
    {
        int idx = get(sorted);
        fprintf(out, "%s\n", items[idx]);
        moveNext(sorted);
</font>    }
}


</pre>
</body>
</html>
