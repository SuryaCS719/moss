<html>
<head>
<title>/fall24/hadinh/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/hadinh/pa1/Lex.c<p></p><pre>
/****************************************************************************************
* Hannah Dinh
* hadinh@ucsc.edu
* pa1
*****************************************************************************************/

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include "List.h"

#define MAX_LEN 160

int main(int argc, char* argv[]){
	if(argc != 3){// if exactly two command line arguments aren't given (input and output files)
		fprintf(stderr, "Usage: %s &lt;input file&gt; &lt;output file&gt;\n", argv[0]); //print error
		return 1;
	}
	
	//open input file for reading
	FILE *in = fopen(argv[1], "r");
	if(in == NULL){
		fprintf(stderr, "Error: Could not open input file %s\n", argv[1]);
		return 1;
	}
	
	//open the output file for writing
	FILE *out = fopen(argv[2], "w");
	if(out == NULL){
		fprintf(stderr, "Error: Could not open output file %s\n", argv[2]);
		fclose(in);
		return 1;
	}
	
	//count number of lines in input file
	char line[MAX_LEN]; //buffer/temporary storage
	int lineCount = 0;
	while(fgets(line, MAX_LEN, in) != NULL){ //read each line in file
		lineCount++; //increment with each line read
	}
	
	//rewind file to read again
	rewind(in);
	
	//allocate memory for storing lines in a string array (char pointers)
	char **lines = calloc(lineCount, sizeof(char*)); //allocate memory for linecount # of pointers
	for(int i = 0; i &lt; lineCount; i++){
		lines[i] = calloc(MAX_LEN, sizeof(char)); //allocate memory for each line (up to MAX_LEN)
	}
	
	//read lines from input file into array
	int i = 0;
	while(fgets(lines[i], MAX_LEN, in) != NULL){ //read each line, store in array
		lines[i][strcspn(lines[i], "\n")] = '\0';  //remove newline char
		i++;
	}
	
	//create new List to store indices for indirect sorting
<a name="1"></a><font color="#00FF00"><a href="match80-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_11.gif"/></a>

	List L = newList();
	append(L, 0);  //insert first index (0)
	
	//use insertion sort to insert indices into list in lexicographical order
	for(i = 1; i &lt; lineCount; i++){
		moveFront(L); //move cursor to front of list
		
		//traverse list
		while(index(L) &gt;= 0){
			if(strcmp(lines[i], lines[get(L)]) &lt; 0){ //compare current line with line at current index in list
</font>				insertBefore(L, i);
				break;
			}
			moveNext(L);
		}
		
<a name="0"></a><font color="#FF0000"><a href="match80-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_17.gif"/></a>

		if(index(L) == -1){
			append(L, i); //if cursor is off list, append index to the end
		}
	}
	
	//use sorted List to write lines to output file
	moveFront(L);
	while(index(L) &gt;= 0){
		fprintf(out, "%s\n", lines[get(L)]);
		moveNext(L);
	}
	
	//free memory
	for(i = 0; i &lt; lineCount; i++){
		free(lines[i]);
	}
	free(lines);
	freeList(&amp;L);
	
	//Close files
	fclose(in);
	fclose(out);
	
	return 0;
</font>}
</pre>
</body>
</html>
