<html>
<head>
<title>/fall24/ssthoth1/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/ssthoth1/pa1/Lex.c<p></p><pre>
/*
Lex.c
Sritha Sthoththrabhashyam
ssthoth1
pa1
*/

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdbool.h&gt;
#include &lt;string.h&gt;
#include "List.h"

int main(int argc, char *argv[]){
    if (argc != 3) {
        fprintf(stderr, "Lex.c Error: Must have exactly two arguments");
        exit(EXIT_FAILURE);
    }

    //for counting the lines:
    FILE *inputFile = fopen(argv[1], "r");
    int lines = 0;
    if (inputFile == NULL) {
        fprintf(stderr, "Lex.c Error: input file doesn't exist");
        exit(EXIT_FAILURE);
    }

    char buffer[BUFSIZ];
    while (fgets(buffer, sizeof(buffer), inputFile)) {
        
        lines++;
    }
    
    printf("The number of lines in input: %d\n", lines);

    //making the string array
    rewind(inputFile);

    
    
    char** array = calloc(lines, sizeof(char*));
    
    for (int i = 0; i &lt; lines; i++) {
        if (fgets(buffer, sizeof(buffer), inputFile)) {
            // Strip newline character, if present
<a name="0"></a><font color="#FF0000"><a href="match200-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_9.gif"/></a>

            size_t len = strlen(buffer);
            if (len &gt; 0 &amp;&amp; buffer[len - 1] == '\n') {
                buffer[len - 1] = '\0'; // Remove newline
            }

            // Allocate memory for each string
            array[i] = malloc(strlen(buffer) + 1);
</font>            if (array[i] == NULL) { // Check for memory allocation failure
                perror("Memory allocation failed for a line");
<a name="1"></a><font color="#00FF00"><a href="match200-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_7.gif"/></a>

                for (int j = 0; j &lt; i; j++) {
                    free(array[j]);
                }
                free(array);
                fclose(inputFile);
                exit(EXIT_FAILURE);
            }
            strcpy(array[i], buffer); // Copy the string into the allocated space
</font>        } else {
            printf("Error reading line %d or EOF encountered.\n", i + 1);
            break; // Stop reading if fgets fails (EOF or error)
        }
    }

    fclose(inputFile);

    List sortList = newList();
    append(sortList, 0);


    for(int i = 1; i &lt; lines; i++) {
        moveFront(sortList);
        char* line = array[i];
        
        while(index(sortList) &gt;= 0) {
            
            if (strcmp(line, array[get(sortList)]) == 0) {
                insertAfter(sortList, i);
                break;
                
            }
            else if (strcmp(line, array[get(sortList)]) &lt; 0) {
                insertBefore(sortList, i);
                break;
                
            }
            else {
                if (index(sortList) == length(sortList) - 1) {
                    append(sortList, i);
                    break;
                    
                }else {
                    moveNext(sortList);
                }
            
            }
            
        }
        
    }

    FILE* outputFile = fopen(argv[2], "w");
    moveFront(sortList);
    for(int i =0; i &lt; lines; i++) {
        fprintf(outputFile, "%s", array[get(sortList)]);
        if (i != lines - 1) {
            fprintf(outputFile, "\n");
        }
        moveNext(sortList);
    }


    //cleanup
    for (int i = 0; i &lt; lines; i++) {
        free(array[i]);
    }
    free(array);
    freeList(&amp;sortList);

    fclose(outputFile);

    return 0;
    


}</pre>
</body>
</html>
