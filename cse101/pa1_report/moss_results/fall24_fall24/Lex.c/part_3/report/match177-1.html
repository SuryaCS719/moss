<html>
<head>
<title>/fall24/shakamat/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/mturrubi/pa1/Lex.c<p></p><pre>
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;  // Include string.h for strdup
#include "List.h"

void sortLines(char** lines, int n, List L) {
    for (int i = 0; i &lt; n; i++) {
        // Start with the current index
        moveBack(L);
        while (index(L) &gt;= 0 &amp;&amp; strcmp(lines[i], lines[get(L)]) &lt; 0) {
            movePrev(L);
        }
        if (index(L) == -1) {
            prepend(L, i); // Insert at the front
        } else {
            insertAfter(L, i); // Insert after the current index
        }
    }
}



int main(int argc, char* argv[]) {
    if (argc != 3) {
        fprintf(stderr, "Usage: %s &lt;input file&gt; &lt;output file&gt;\n", argv[0]);
        exit(EXIT_FAILURE);
    }

<a name="0"></a><font color="#FF0000"><a href="match177-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_11.gif"/></a>

    FILE* inFile = fopen(argv[1], "r");
    if (inFile == NULL) {
        fprintf(stderr, "Unable to open file %s for reading.\n", argv[1]);
        exit(EXIT_FAILURE);
    }

    // Read lines into dynamic array
    char** lines = NULL;
    size_t lineCount = 0;
</font>    size_t capacity = 10;
    lines = malloc(capacity * sizeof(char*));
    char buffer[256];

    while (fgets(buffer, sizeof(buffer), inFile) != NULL) {
        // Remove newline character
        buffer[strcspn(buffer, "\n")] = 0;
        
        if (lineCount &gt;= capacity) {
            capacity *= 2;
<a name="1"></a><font color="#00FF00"><a href="match177-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_9.gif"/></a>

            lines = realloc(lines, capacity * sizeof(char*));
        }

        // Allocate memory for the string and copy it
        lines[lineCount] = malloc(strlen(buffer) + 1); // +1 for null terminator
        strcpy(lines[lineCount], buffer);
        lineCount++;
    }
    fclose(inFile);

    // Create a List for sorting indices
    List L = newList();
    sortLines(lines, lineCount, L);
</font>
    // Write sorted lines to output file
    FILE* outFile = fopen(argv[2], "w");
    if (outFile == NULL) {
        fprintf(stderr, "Unable to open file %s for writing.\n", argv[2]);
        exit(EXIT_FAILURE);
    }

    moveFront(L);
    while (index(L) &gt;= 0) {
        int idx = get(L);
        fprintf(outFile, "%s\n", lines[idx]);
        moveNext(L);
    }

    // Clean up
    fclose(outFile);
    for (size_t i = 0; i &lt; lineCount; i++) {
        free(lines[i]);
    }
    free(lines);
    freeList(&amp;L);

    return 0;
}

</pre>
</body>
</html>
