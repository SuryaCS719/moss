<html>
<head>
<title>/fall24/saqadiri/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/saqadiri/pa1/Lex.c<p></p><pre>
//-----------------------------------------------------------------------------
// Salma Qadiri
// Saqadiri@ucsc.edu
//pa1
//Lex.c
// takes 2 cmd line args: input and output file names
// reads lines from the in file, stores them in an array, then uses the List ADT to sort lines
// writes the sorted lines to the out file.
//-----------------------------------------------------------------------------
#include &lt;stdio.h&gt; 
#include &lt;stdlib.h&gt; 
#include &lt;string.h&gt; 
#include "List.h" 

#define LINE_LENGTH_LIMIT 256 

<a name="1"></a><font color="#00FF00"><a href="match136-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_12.gif"/></a>

int main(int argc, char* argv[]) {

//  command line arguments--------------------------------------------------------------------
    if (argc != 3) { 
        fprintf(stderr, "Invalid input: please use %s &lt;input file&gt; &lt;output file&gt;\n", argv[0]);
        exit(EXIT_FAILURE);
    }

    FILE *in_file, *out_file; // file pointers for in and out files
    in_file = fopen(argv[1], "r"); // open the in file to read
</font>    if (in_file == NULL) { 
        fprintf(stderr, "Can't read from file %s\n", argv[1]);
        exit(EXIT_FAILURE);
    }

    out_file = fopen(argv[2], "w"); // open the out file to write
<a name="0"></a><font color="#FF0000"><a href="match136-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_12.gif"/></a>

    if (out_file == NULL) { //if outfile is null, print the error message
        fprintf(stderr, "Can't write to file %s\n", argv[2]);
        fclose(in_file);
        exit(EXIT_FAILURE);
    }

 // count # of lines and read into an array--------------------------------------------------------------------

    char temp_line[LINE_LENGTH_LIMIT]; // temp char to store the lines
    int total_lines = 0;

    while (fgets(temp_line, LINE_LENGTH_LIMIT, in_file) != NULL) { 
</font>        total_lines++; // increment line counter after reading all lines
    }

    rewind(in_file); // move the pointer back start 

    char** inp_lines = calloc(total_lines, sizeof(char*)); // allocating mem 
    for (int x = 0; x &lt; total_lines; x++) { //iterating trough the lines
        fgets(temp_line, LINE_LENGTH_LIMIT, in_file); // read line 
        inp_lines[x] = malloc((strlen(temp_line) + 1) * sizeof(char)); // allocate mem
        strcpy(inp_lines[x], temp_line); 

 // make list ot hold indicies and then sort --------------------------------------------------------------------

    List indices = newList(); // new empty list for indices
    for (int x = 0; x &lt; total_lines; x++) {
        moveFront(indices); 
        while (index(indices) &gt;= 0) {
            int y = get(indices); // get the val at position of the cursor 
            if (strcmp(inp_lines[x], inp_lines[y]) &lt; 0) {
                insertBefore(indices, x); // if it is smaller insert the curr index before the cursor 
                break;
            }
            moveNext(indices); // cursor gets moved to the next position
        }
        if (index(indices) == -1) {
            append(indices, x); // append the curr index 
        }
    }

 // write new lines to the output file --------------------------------------------------------------------

    moveFront(indices);  
    while (index(indices) &gt;= 0) {
        fprintf(out_file, "%s", inp_lines[get(indices)]); // write current index linr to the outfile
        moveNext(indices); // move cursor to the next position
    }

 // free all memory --------------------------------------------------------------------
    
    for (int x = 0; x &lt; total_lines; x++) {
        free(inp_lines[x]); 
    }
    free(inp_lines); 
    freeList(&amp;indices);  

    fclose(in_file); 
    fclose(out_file); 

    return 0; 
}</pre>
</body>
</html>
