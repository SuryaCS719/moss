<html>
<head>
<title>/fall24/rgiancha/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/sskolach/pa1/Lex.c<p></p><pre>
//-----------------------------------------------------------------------------
// Saranya Kolachana
// sskolach
// pa1
// Lex.c
//-----------------------------------------------------------------------------

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdbool.h&gt;
#include &lt;string.h&gt;
#include "List.h"

#define MAX_LEN 300




int stringComp(int x, int y, char** line_arr) {
    char* a = line_arr[x];
    char* b = line_arr[y];

    return strcmp(a, b);
}



<a name="1"></a><font color="#00FF00"><a href="match242-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_6.gif"/></a>

int main(int argc, char * argv[]){

   int line_count;
   FILE *in, *out;
   char line[MAX_LEN]; 

   // check command line for correct number of arguments
    if( argc != 3 ){
        printf("Usage: %s &lt;input file&gt; &lt;output file&gt;\n", argv[0]);
</font>        exit(1);
    }

   // open files for reading and writing 
   in = fopen(argv[1], "r");
      if( in==NULL ){
      printf("Unable to open file %s for reading\n", argv[1]);
      exit(1);
   }

   out = fopen(argv[2], "w");
   if( out==NULL ){
<a name="0"></a><font color="#FF0000"><a href="match242-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_7.gif"/></a>

      printf("Unable to open file %s for writing\n", argv[2]);
      exit(1);
   }

   // read each line of input file, then count and print tokens
   line_count = 0;
   while( fgets(line, MAX_LEN, in) != NULL)  {
      line_count++;
      
   }
   char** line_arr = calloc(line_count, sizeof(char*));
</font>   if (line_arr == NULL) {
        fprintf(out, "%s", "line_arr is null");
        fclose(in);
        fclose(out);
        return 1;
      }
   
   //set the file position back to the beginning
   rewind(in);

   

  for (int i = 0; i &lt; line_count; i++) {
        line_arr[i] = calloc(MAX_LEN, sizeof(char));
        if (line_arr[i] == NULL) {
            printf("Memory allocation error\n");
            fclose(in);
            fclose(out);
            // Free allocated memory before exiting
            for (int j = 0; j &lt; i; j++) {
                free(line_arr[j]);
            }
            free(line_arr);
            return 1;
        }

        if (fgets(line_arr[i], MAX_LEN, in) == NULL) {
            printf("Error reading line\n");
            fclose(in);
            fclose(out);
            // Free allocated memory before exiting
            for (int j = 0; j &lt;= i; j++) {
                free(line_arr[j]);
            }
            free(line_arr);
            return 1;
        }
    }
   // close files 
   fclose(in);
   

    List L = newList();
    append(L, 0);
    for (int i = 1; i &lt; line_count; i++) {
        append(L, i);
        moveBack(L);
        int key_index = get(L);
        movePrev(L);
        while (index(L) &gt;= 0 &amp;&amp; stringComp(get(L), key_index, line_arr) &gt; 0) {
            int curr = get(L);
            moveNext(L);
            set(L, curr);
            movePrev(L);
            movePrev(L);
        }
        if(index(L) &lt; 0) {
            moveFront(L);
        }
        else {
            moveNext(L);
        }
        set(L, key_index); 
    }
   
    moveFront(L);
    while(index(L)&gt;=0) {
        char* s = line_arr[get(L)];
        fprintf(out, "%s", s);
        moveNext(L);
    }
    



    for (int i = 0; i &lt; line_count; i++) {
        free(line_arr[i]);
        
    }
    free(line_arr);
    
    freeList(&amp;L);
   
    fclose(out);
   

   return(0);
}



</pre>
</body>
</html>
