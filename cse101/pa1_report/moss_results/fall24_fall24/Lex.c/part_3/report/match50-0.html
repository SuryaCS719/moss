<html>
<head>
<title>/fall24/vvsinha/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/vvsinha/pa1/Lex.c<p></p><pre>
/*** 
 * Vipransh Sinha
 * vvsinha
 * 2024 Fall CSE101 PA1
 * Lex.c
 * Description: Main file for PA1, Runs sorting algorithm, and writes to outfile
***/
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include "List.h"


int main (int argc, char *argv[]){
    
    //check correct # of arguements
    if(argc != 3){
        fprintf(stderr, "Usage: %s &lt;input file&gt; &lt;output file&gt;\n", argv[0]);
        return EXIT_FAILURE;
    }

    //open input file
    FILE *in = fopen(argv[1], "r");
    if(in == NULL){
        fprintf(stderr, "Unable to open file %s for reading\n", argv[1]);
        return EXIT_FAILURE;
    }


    //open output file
<a name="2"></a><font color="#0000FF"><a href="match50-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_8.gif"/></a>

    FILE *out = fopen(argv[2], "w");
    if (out == NULL) {
        fprintf(stderr, "Unable to open file %s for writing\n", argv[2]);
        fclose(in);
        return EXIT_FAILURE;
    }

    int line = 0;
    char c;
</font>
    //count number of lines in the file
    while((c = getc(in)) != EOF){
        if(c == '\n'){
            line++;
        }
    }

    rewind(in);

    //allocate memory
    char **lines = calloc(line, sizeof(char *));
    
    //null case
    if(lines == NULL){
        fprintf(stderr, " Memory Allocation Failure\n");
        fclose(in);
        fclose(out);
        return EXIT_FAILURE;
    }

<a name="0"></a><font color="#FF0000"><a href="match50-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_11.gif"/></a>

    char buffer[2048];
    for(int i = 0; i &lt; line; i++){
        if(fgets(buffer, sizeof(buffer), in) != NULL){
            lines[i] = calloc(strlen(buffer) + 1, sizeof(char));
</font>            if(lines[i] == NULL){
                fprintf(stderr, "Memory Allocation Failure\n");
                for(int j = 0; j &lt; i; j++){
                    free(lines[j]);
                }
                free(lines);
                fclose(in);
                fclose(out);
                return EXIT_FAILURE;
            }
            strcpy(lines[i], buffer);
        }
    }

    //sort the lines (insertion sort)
    List L = newList();
    append(L, 0);

    for(int i = 1; i &lt; line; i++){
        moveFront(L);
<a name="1"></a><font color="#00FF00"><a href="match50-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_10.gif"/></a>

        while(index(L) &gt;= 0  &amp;&amp; strcmp(lines[i], lines[get(L)]) &gt; 0){
            moveNext(L);
        }   
        if(index(L) &gt;= 0){
            insertBefore(L, i);
        } else {
            append(L, i);
        }
    }

    //write to file
    for(moveFront(L); index(L) &gt;= 0; moveNext(L)){
        fprintf(out, "%s", lines[get(L)]);
</font>    }


    //free memory
    for(int i = 0; i &lt; line; i++){
        free(lines[i]);
    }
    clear(L);
    free(lines);
    freeList(&amp;L);
    fclose(in);
    fclose(out);
    return EXIT_SUCCESS;
}


</pre>
</body>
</html>
