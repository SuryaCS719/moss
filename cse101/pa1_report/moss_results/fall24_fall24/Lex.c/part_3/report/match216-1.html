<html>
<head>
<title>/fall24/jlu161/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/aanbaner/pa1/Lex.c<p></p><pre>
#include&lt;stdio.h&gt;
#include&lt;stdlib.h&gt;
#include&lt;stdbool.h&gt;
#include&lt;string.h&gt;
#include "List.h"

#define MAX_LEN 300

// #define DEBUG

<a name="1"></a><font color="#00FF00"><a href="match216-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_8.gif"/></a>

int main(int argc, char * argv[]){

    int line_count;
    FILE *in, *out;
    char line[MAX_LEN];

    // check command line for correct number of arguments
    if( argc != 3 ){
        printf("Usage: %s &lt;input file&gt; &lt;output file&gt;\n", argv[0]);
</font>        exit(1);
    }

    // open files for reading and writing 
    in = fopen(argv[1], "r");
        if( in==NULL ){
        printf("Unable to open file %s for reading\n", argv[1]);
        exit(1);
    }

    out = fopen(argv[2], "w");
    if( out==NULL ){
<a name="0"></a><font color="#FF0000"><a href="match216-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_8.gif"/></a>

        printf("Unable to open file %s for writing\n", argv[2]);
        exit(1);
    }

    // read each line of input file, then count and print tokens

    line_count = 0;
    while( fgets(line, MAX_LEN, in) != NULL)  {
        line_count++;
    }

    char** lines = malloc(line_count * sizeof(char*));
</font>
    rewind(in);

    int counter = 0;
    while( fgets(line, MAX_LEN, in) != NULL)  {
        // lines[counter] = strdup(line); // duplicate line string into the lines array at the index counter
        lines[counter] = malloc(sizeof(char*) * strlen(line));
        strcpy(lines[counter],line);
        counter++;
    }

#ifdef DEBUG
    for (int i = 0; i &lt; line_count; i++) {
        printf("%d: %s", i, lines[i]);
    }
#endif

#ifdef DEBUG
    printf("\n\n\n");
#endif

    // create a linked list of numbers that all operate on 
    List L = newList();
    append(L,0);
    
    // insertion sort
    for (int i = 1; i &lt; line_count; i++) { // for each line of the file
#ifdef DEBUG
        printf("\nword being sorted: %s", lines[i]);
        printList(stdout,L);
        printf("\nbeginning insertion sort iteration:\n");
#endif
        moveFront(L);

        unsigned char sorted = 0;

        while (index(L) != -1) { // iterate through the linked list L
#ifdef DEBUG
            printf("index of L: %d\n", get(L));
            printf("current word being compared: %s", lines[get(L)]);
            printf("string compare: %d\n", strcmp(lines[i], lines[get(L)]));
#endif
            if (strcmp(lines[i], lines[get(L)]) &lt;= 0) { // if index i of the lines comes before the line pointed to by L's cursor
#ifdef DEBUG
                printf("SWAPPED\n");
#endif
                sorted++;
                insertBefore(L, i); // insert i before the current item
                moveBack(L);
            }

            moveNext(L);
        }
        if (!sorted) append(L,i);
    }

    // L now represents the indices in order of how their respective lines should be organized lexicographically

#ifdef DEBUG
    fprintf(out, "\n");
    printf("\n\n\n");
#endif
    // begin printing ordered lines
    moveFront(L);
    while (index(L) != -1) { // iterate through the linked list L
#ifdef DEBUG
        printf("%d: %s", get(L), lines[get(L)]);
#endif
        fprintf(out, "%s", lines[get(L)]); // print out the line stored at L's current cursor on a new line
        free(lines[get(L)]);
        moveNext(L);
    }

        // // print tokens in this line
        // fprintf(out, "line %d contains %d ", line_count, token_count);
        // fprintf(out, "token%s: \n", token_count==1?"":"s" );
        // fprintf(out, "%s\n", tokenBuffer);

    freeList(&amp;L);
    free(lines);


    // close files 
    fclose(in);
    fclose(out);

    return(0);
}</pre>
</body>
</html>
