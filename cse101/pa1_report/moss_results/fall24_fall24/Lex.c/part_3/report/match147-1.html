<html>
<head>
<title>/fall24/cevail/pa1/Lex.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/psvasan/pa1/Lex.c<p></p><pre>
//-----------------------------------------------------------------------------
// Pratyush Vasan
// psvasan
// Fall 2024 CSE101 PTANTALO PA1
// Lex.c
// Reads input file and lexicographically sorts all lines using the List ADT and prints them out to specified file
//-----------------------------------------------------------------------------

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include "List.h"

char* strdup(const char* str) {
    size_t len = strlen(str) + 1;
    char* copy = malloc(len);
    if (copy) {
        memcpy(copy, str, len);
    }
    return copy;
}


int main(int argc, char* argv[]) {
<a name="0"></a><font color="#FF0000"><a href="match147-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_11.gif"/></a>

    if (argc != 3) {
        fprintf(stderr, "Usage: %s &lt;input file&gt; &lt;output file&gt;\n", argv[0]);
        return 1;
    }

    FILE* inFile = fopen(argv[1], "r");
    FILE* outFile = fopen(argv[2], "w");
</font>
    if (inFile == NULL) {
        fprintf(stderr, "Error: cannot open file %s for reading\n", argv[1]);
        return 1;
    }
    if (outFile == NULL) {
        fprintf(stderr, "Error: cannot open file %s for writing\n", argv[2]);
        return 1;
    }

    // Read lines from input file and store them in an array
    char line[256];
    int numLines = 0;
    while (fgets(line, sizeof(line), inFile)) {
        numLines++;
    }

    rewind(inFile);
    char** lines = malloc(numLines * sizeof(char*));
    for (int i = 0; i &lt; numLines; i++) {
<a name="1"></a><font color="#00FF00"><a href="match147-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_10.gif"/></a>

        fgets(line, sizeof(line), inFile);
        lines[i] = strdup(line);
    }

    // Create list of indices for indirect sorting
    List L = newList();
    append(L, 0);
    for (int i = 1; i &lt; numLines; i++) {
        moveFront(L);
        while (index(L) &gt;= 0 &amp;&amp; strcmp(lines[get(L)], lines[i]) &lt; 0) {
</font>            moveNext(L);
        }
        if (index(L) == -1) append(L, i);
        else insertBefore(L, i);
    }

    // Write sorted lines to output file
    moveFront(L);
    while (index(L) &gt;= 0) {
        char* line = lines[get(L)];
        // Check if the line already has a newline at the end
        if (line[strlen(line) - 1] != '\n') {
            fprintf(outFile, "%s\n", line);  // Add newline explicitly
        } else {
            fprintf(outFile, "%s", line);    // Line already has newline
        }
        moveNext(L);
    }

    // Clean up
    for (int i = 0; i &lt; numLines; i++) {
        free(lines[i]);
    }
    free(lines);
    freeList(&amp;L);
    fclose(inFile);
    fclose(outFile);

    return 0;
}</pre>
</body>
</html>
