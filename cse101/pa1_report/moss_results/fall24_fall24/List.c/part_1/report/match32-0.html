<html>
<head>
<title>/fall24/cevail/pa1/List.c</title>
</head>
<body bgcolor="white">
<hr/>
/fall24/cevail/pa1/List.c<p></p><pre>
//---------------------------------------------------
// "List.c"
// List ADT Functions
// Charles Vail (cevail@ucsc.edu)
//---------------------------------------------------
// Include Statements -----------------
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdbool.h&gt;
#include "List.h"
// Define Statements ------------------
// Constructors and Destructors --------
<a name="0"></a><font color="#FF0000"><a href="match32-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_61.gif"/></a>

List newList(void)
{
        List L = malloc(sizeof(ListObj));
        if (L == NULL)
        {
                fprintf(stderr, "Memory could not be allocated.\n");
                exit(1);
        }
        L-&gt;front = NULL;
        L-&gt;back = NULL;
        L-&gt;cursor = NULL;
        L-&gt;list_length = 0;
        return L;
}
void freeList(List *pL)
{
        if (pL != NULL &amp;&amp; *pL != NULL)
        {
                ListNode* current = (*pL)-&gt;front;
                while (current != NULL)
                {
                        ListNode* t = current;
                        current = current-&gt;next;
                        free(t);
                }
                free(*pL);
                *pL = NULL;
        }
}
// Access Functions -------------------
int length(List L)
{
        if (L == NULL)
        {
                fprintf(stderr, "Error. NULL! \n");
                exit(1);
        }
        return L-&gt;list_length;
}
int cursorIndex(List L)
{
        if (L == NULL)
        {
                fprintf(stderr, "Error. NULL! \n");
                return -1;
        }
        if (L-&gt;cursor == NULL)
        {
                return -1;
        }
        ListNode* current = L-&gt;front;
        int data = 0;
        while (current != NULL)
        {
                if (current == L-&gt;cursor)
                {
                        return data;
                }
                current = current-&gt;next;
                data++;
        }
        return -1;
}
int front(List L)
{
        if (L == NULL || L-&gt;list_length == 0)
        {
                fprintf(stderr, "Error. Empty List!\n");
                exit(1);
        }
        return L-&gt;front-&gt;data;
}
int back(List L)
{
        if (L == NULL || L-&gt;list_length == 0)
        {
                fprintf(stderr, "Error. Empty List! \n");
                exit(1);
        }
        return L-&gt;back-&gt;data;
}
int get(List L)
{
        if (L == NULL)
        {
                fprintf(stderr, "Undefined List!\n");
                return NIL;
        }
	if (L-&gt;cursor == NULL)
	{
		fprintf(stderr, "Cursor undefined or empty list!\n");
		return NIL;
	}
        return L-&gt;cursor-&gt;data;
}
bool equals(List A, List B)
{
        if (A-&gt;list_length != B-&gt;list_length)
        {
                return 0;
        }
        ListNode* nodeA = A-&gt;front;
        ListNode* nodeB = B-&gt;front;
        while (nodeA != NULL)
        {
                if (nodeA-&gt;data != nodeB-&gt;data)
                {
                         return 0;
                }
                nodeA = nodeA-&gt;next;
                nodeB = nodeB-&gt;next;
        }
        return nodeA == NULL &amp;&amp; nodeB == NULL;
}
// Manipulation Functions -------------
void clear(List L)
{
        while (L-&gt;list_length &gt; 0)
        {
                deleteFront(L);
        }
}
void set(List L, int x)
{
        if (L-&gt;cursor == NULL)
        {
                fprintf(stderr, "Undefined Cursor!");
                exit(1);
        }
        L-&gt;cursor-&gt;data = x;
}
void moveFront(List L)
{
	if (L == NULL)
	{
		fprintf(stderr, "Error! List in NULL.\n");
		return;
	}
        if (L-&gt;list_length &gt; 0)
        {
                L-&gt;cursor = L-&gt;front;
        }
	else
	{
		L-&gt;cursor = NULL;
	}
}
void moveBack(List L)
{
	if (L == NULL)
	{
		fprintf(stderr, "Error! List is NULL.\n");
		return;
	}
        if (L-&gt;list_length &gt; 0)
        {
                L-&gt;cursor = L-&gt;back;
        }
	else
	{
		L-&gt;cursor = NULL;
	}
}
void movePrev(List L)
{
        if (L == NULL || L-&gt;cursor == NULL)
        {
                fprintf(stderr, "Error! Undefined or empty list.\n");
                return;
        }
        if (L-&gt;cursor != L-&gt;front)
        {
                L-&gt;cursor = L-&gt;cursor-&gt;prev;
        } else {
		L-&gt;cursor = NULL;
	}
}
void moveNext(List L)
{
        if (L == NULL || L-&gt;cursor == NULL)
        {
                fprintf(stderr, "Error! Undefined or empty list!\n");
                return;
        }
        if (L-&gt;cursor != L-&gt;back)
        {
		L-&gt;cursor = L-&gt;cursor-&gt;next;
	} else {
		L-&gt;cursor = NULL;
	}
}
void prepend(List L, int x)
{
	if (!L)
	{
		fprintf(stderr, "Error! List DNE!\n");
		exit(1);
	}
	ListNode* newNode = malloc(sizeof(ListNode));
	if (!newNode)
	{
		fprintf(stderr, "Error! Could not prepend!\n\n");
		exit(1);
	}
	newNode-&gt;data = x;
	newNode-&gt;next = L-&gt;front;
	newNode-&gt;prev = NULL;
	if (L-&gt;front != NULL)
	{
		L-&gt;front-&gt;prev = newNode;
	}
	L-&gt;front = newNode;
	if (L-&gt;back == NULL)
	{
		L-&gt;back = newNode;
	}
	L-&gt;list_length++;
	L-&gt;cursor = newNode;
}
void append(List L, int x)
{
        if (!L)
        {
                fprintf(stderr, "Error, List doesn't exit /n");
                exit(1);
        }
	ListNode* newNode = malloc(sizeof(ListNode));
	if (!newNode)
	{
		fprintf(stderr, "Error! Could not append!\n\n");
		exit(1);
	}
	newNode-&gt;data = x;
	newNode-&gt;next = NULL;
	newNode-&gt;prev = L-&gt;back;
	if (L-&gt;back != NULL)
	{
		L-&gt;back-&gt;next = newNode;
	} else
	{
		L-&gt;front = newNode;
	}
	L-&gt;back = newNode;
	L-&gt;list_length++;
	L-&gt;cursor = newNode;
}
void insertBefore(List L, int x)
{
	if (!L || L-&gt;cursor == NULL)
	{
		fprintf(stderr, "Error! List NULL or cursor not set!\n");
		exit(1);
	}
	ListNode* newNode = malloc(sizeof(ListNode));
	if (!newNode)
	{
		fprintf(stderr, "Error! Unable to allocate memory!\n");
		exit(1);
	}
	newNode-&gt;data = x;
	newNode-&gt;prev = L-&gt;cursor-&gt;prev;
	newNode-&gt;next = L-&gt;cursor;
	if (L-&gt;cursor-&gt;prev != NULL)
</font>	{
<a name="2"></a><font color="#0000FF"><a href="match32-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_7.gif"/></a>

		L-&gt;cursor-&gt;prev-&gt;next = newNode;
	}
	else
	{
		L-&gt;front = newNode;
	}
	L-&gt;cursor-&gt;prev = newNode;
	L-&gt;list_length++;
}
void insertAfter(List L, int x)
{
	if (!L || L-&gt;cursor == NULL)
        {
                fprintf(stderr, "Error! List NULL or cursor not set!\n");
                exit(1);
        }
        ListNode* newNode = malloc(sizeof(ListNode));
        if (!newNode)
        {
                fprintf(stderr, "Error! Unable to allocate memory!\n");
                exit(1);
        }
        newNode-&gt;data = x;
        newNode-&gt;prev = L-&gt;cursor;
        newNode-&gt;next = L-&gt;cursor-&gt;next;
        if (L-&gt;cursor-&gt;next != NULL)
</font>        {
                L-&gt;cursor-&gt;next-&gt;prev = newNode;
        }
<a name="1"></a><font color="#00FF00"><a href="match32-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_28.gif"/></a>

        else
        {
                L-&gt;back = newNode;
        }
        L-&gt;cursor-&gt;next = newNode;
        L-&gt;list_length++;
}
void deleteFront(List L)
{
	if (L == NULL || L-&gt;list_length == 0)
	{
		fprintf(stderr, "ERROR!!!\n");
		return;
	}
	ListNode* t = L-&gt;front;
	if (L-&gt;list_length == 1)
	{
		L-&gt;front = L-&gt;back = L-&gt;cursor = NULL;
	}
	else
	{
		L-&gt;front = L-&gt;front-&gt;next;
		L-&gt;front-&gt;prev = NULL;
	}
	free(t);
	L-&gt;list_length--;
}
void deleteBack(List L)
{
	if (L == NULL || L-&gt;list_length == 0)
        {
                fprintf(stderr, "ERROR!!!\n");
                return;
        }
	ListNode* t = L-&gt;back;
        if (L-&gt;list_length == 1)
        {
   		L -&gt;front = L-&gt;back = L-&gt;cursor = NULL;
        }
        else
        {
                L-&gt;back = L-&gt;back-&gt;prev;
                L-&gt;back-&gt;next = NULL;
        }
        free(t);
        L-&gt;list_length--;
}
void delete(List L)
{
	if (L == NULL || L-&gt;cursor == NULL)
	{
		fprintf(stderr, "Error!\n\n");
		return;
	}
	ListNode* t = L-&gt;cursor;
	printf("Testing: %d\n", t-&gt;data);
	if (t-&gt;prev != NULL)
	{
		t-&gt;prev-&gt;next = t-&gt;next;
	}
	if (t-&gt;next != NULL)
	{
		t-&gt;next-&gt;prev = t-&gt;prev;
	} else {
		L-&gt;back = t-&gt;prev;
	}
	free(t);
	L-&gt;cursor = NULL;
	L-&gt;list_length--;
}
// Other ------------------------------
void printList(FILE* out, List L)
{
	if (L == NULL || out == NULL)
	{
		return;
	}
        ListNode* current = L-&gt;front;
        while (current != NULL)
        {
		if (current-&gt;next == NULL)
		{
			fprintf(out, "%d", current-&gt;data);
		} else {
                	fprintf(out, "%d,", current-&gt;data);
		}
		current = current-&gt;next;
        }
        fprintf(out,"\n");
}
List copyList(List L)
{
	if (L == NULL)
	{
		return NULL;
	}
	List copy = newList();
	if (copy == NULL)
	{
		fprintf(stderr, "Error! Unable to allocate new memory for list!\n");
		exit(1);
	}
	ListNode* current = L-&gt;front;
	while (current != NULL)
	{
		append(copy, current-&gt;data);
		current = current-&gt;next;
	}
	return copy;
</font>}
//---------------------------------------

</pre>
</body>
</html>
